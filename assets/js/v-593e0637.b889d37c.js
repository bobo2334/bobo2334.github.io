"use strict";(self.webpackChunkvuepress_notes=self.webpackChunkvuepress_notes||[]).push([[990],{7676:(n,e,s)=>{s.r(e),s.d(e,{data:()=>a});const a={key:"v-593e0637",path:"/articles/deploy-vuepress-project-to-github-pages-with-github-actions.html",title:"利用 Github Actions 部署 Vuepress 项目到 Github Pages",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"前言",slug:"前言",children:[]},{level:2,title:"创建 Github 仓库",slug:"创建-github-仓库",children:[]},{level:2,title:"配置 Github Actions",slug:"配置-github-actions",children:[]},{level:2,title:"配置 Github Pages",slug:"配置-github-pages",children:[]}],filePathRelative:"articles/deploy-vuepress-project-to-github-pages-with-github-actions.md",git:{updatedTime:1629819746e3,contributors:[]}}},5087:(n,e,s)=>{s.r(e),s.d(e,{default:()=>tn});var a=s(6252),t=s(1652),l=s(8867);const o=(0,a._)("h1",{id:"利用-github-actions-部署-vuepress-项目到-github-pages",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#利用-github-actions-部署-vuepress-项目到-github-pages","aria-hidden":"true"},"#"),(0,a.Uk)(" 利用 Github Actions 部署 Vuepress 项目到 Github Pages")],-1),u=(0,a._)("h2",{id:"前言",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),(0,a.Uk)(" 前言")],-1),i=(0,a._)("p",null,[(0,a.Uk)("Vuepress"),(0,a._)("sup",{class:"footnote-ref"},[(0,a._)("a",{href:"#fn1",id:"fnref1"},"[1]")]),(0,a.Uk)(" 是一个基于 Vue 的静态网站生成器；Github Pages"),(0,a._)("sup",{class:"footnote-ref"},[(0,a._)("a",{href:"#fn2",id:"fnref2"},"[2]")]),(0,a.Uk)(" 是 Github 提供的免费的静态网站托管服务；Github Actions"),(0,a._)("sup",{class:"footnote-ref"},[(0,a._)("a",{href:"#fn3",id:"fnref3"},"[3]")]),(0,a.Uk)(" 是 Github 仓库中集成的 CI/CD"),(0,a._)("sup",{class:"footnote-ref"},[(0,a._)("a",{href:"#fn4",id:"fnref4"},"[4]")]),(0,a.Uk)(" 服务。")],-1),c=(0,a._)("p",null,"Vuepress 是一个 Node.js 项目，它可以根据配置将 Markdown 文件转为 HTML 文件。你可以将输出的静态文件托管在 Github Pages 中，这样你就得到了一个可以访问的域名来展示这些静态的 HTML 文件。",-1),r=(0,a._)("p",null,"传统的做法是在本地安装好 Noed.js 环境，自己手动构建项目之后将构建产物上传到 Github 仓库，从而触发 Github Pages 的构建。现在可以利用 Github Actions 来代替手工劳动，Github Actions 可以自动被触发，它运行在 Github 提供的虚拟环境中，可以执行一系列任务从而代替重复枯燥的手动构建和部署的步骤。",-1),p=(0,a._)("h2",{id:"创建-github-仓库",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#创建-github-仓库","aria-hidden":"true"},"#"),(0,a.Uk)(" 创建 Github 仓库")],-1),_=(0,a._)("p",null,"在创建的 Github 仓库时要注意仓库名称，假如你的用户名是 foo。",-1),k=(0,a._)("p",null,[(0,a.Uk)("如果你创建了一个名为 "),(0,a._)("code",null,"foo.github.io"),(0,a.Uk)(" 的仓库，你将可以通过 "),(0,a._)("code",null,"https://foo.github.io"),(0,a.Uk)(" 来访问此仓库的 Github Pages 内容；")],-1),b=(0,a._)("p",null,[(0,a.Uk)("如果你创建其他名称的仓库如 "),(0,a._)("code",null,"bar"),(0,a.Uk)(" ，你可以通过 "),(0,a._)("code",null,"https://foo.github.io/bar/"),(0,a.Uk)(" 来访问此仓库的 Github Pages 内容。")],-1),h=(0,a._)("p",null,"你可以根据你期望的访问方式来选择仓库名称。",-1),d=(0,a._)("h2",{id:"配置-github-actions",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#配置-github-actions","aria-hidden":"true"},"#"),(0,a.Uk)(" 配置 Github Actions")],-1),g=(0,a._)("p",null,[(0,a.Uk)("Github Actions 的配置文件应该放在项目根目录下的 "),(0,a._)("code",null,".github/workflows/"),(0,a.Uk)(" 文件夹中，你可以在一个项目中配置多个 Actions。配置文件是 YAML 格式，文件名形如 "),(0,a._)("code",null,"*.yml"),(0,a.Uk)(" 。")],-1),f=(0,a._)("p",null,[(0,a.Uk)("每一个 Action 中可以包括多个 job，每个 job 可以包括多个 step。在 step 中你可以直接运行命令，或者引用其他人编写好的 Action 脚本。在本文的配置文件中，我们引用了 github-pages-deploy-action"),(0,a._)("sup",{class:"footnote-ref"},[(0,a._)("a",{href:"#fn5",id:"fnref5"},"[5]")]),(0,a.Uk)(" 来完成 Github Pages 部署，而不用关系其实现细节。")],-1),U=(0,a._)("p",null,"完成本文目标的 Github Actions 配置文件内容如下。",-1),m=(0,a._)("div",{class:"language-yaml ext-yml line-numbers-mode"},[(0,a._)("pre",{class:"language-yaml"},[(0,a._)("code",null,[(0,a._)("span",{class:"token key atrule"},"name"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token string"},'"github actions build and deploy gh-pages"'),(0,a.Uk)("\n"),(0,a._)("span",{class:"token key atrule"},"on"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token key atrule"},"push"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token key atrule"},"branches"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n      "),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)(" master\n"),(0,a._)("span",{class:"token key atrule"},"jobs"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n  "),(0,a._)("span",{class:"token key atrule"},"build-and-deploy"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n    "),(0,a._)("span",{class:"token key atrule"},"runs-on"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" ubuntu"),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)("latest\n    "),(0,a._)("span",{class:"token key atrule"},"steps"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n      "),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"token key atrule"},"name"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" Checkout\n        "),(0,a._)("span",{class:"token key atrule"},"uses"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" actions/checkout@v2.3.1\n        "),(0,a._)("span",{class:"token key atrule"},"with"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n          "),(0,a._)("span",{class:"token key atrule"},"persist-credentials"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token boolean important"},"false"),(0,a.Uk)("\n      "),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"token key atrule"},"name"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" install and build\n        "),(0,a._)("span",{class:"token key atrule"},"run"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(),(0,a._)("span",{class:"token punctuation"},"|"),(0,a._)("span",{class:"token scalar string"},"\n          npm install\n          npm run build"),(0,a.Uk)("\n      "),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)(),(0,a._)("span",{class:"token key atrule"},"name"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" Deploy\n        "),(0,a._)("span",{class:"token key atrule"},"uses"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" JamesIves/github"),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)("pages"),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)("deploy"),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)("action@4.1.4\n        "),(0,a._)("span",{class:"token key atrule"},"with"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)("\n          "),(0,a._)("span",{class:"token key atrule"},"BRANCH"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" gh"),(0,a._)("span",{class:"token punctuation"},"-"),(0,a.Uk)("pages\n          "),(0,a._)("span",{class:"token key atrule"},"FOLDER"),(0,a._)("span",{class:"token punctuation"},":"),(0,a.Uk)(" docs/.vuepress/dist\n")])]),(0,a._)("div",{class:"line-numbers"},[(0,a._)("span",{class:"line-number"},"1"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"2"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"3"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"4"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"5"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"6"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"7"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"8"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"9"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"10"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"11"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"12"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"13"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"14"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"15"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"16"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"17"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"18"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"19"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"20"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"21"),(0,a._)("br"),(0,a._)("span",{class:"line-number"},"22"),(0,a._)("br")])],-1),y=(0,a._)("p",null,"其中的一些关键配置解释如下。",-1),G=(0,a._)("ul",null,[(0,a._)("li",null,[(0,a._)("code",null,"on.push.branches"),(0,a.Uk)(" ，在推送到 "),(0,a._)("code",null,"master"),(0,a.Uk)(" 分支时触发此 Action；")]),(0,a._)("li",null,[(0,a._)("code",null,"jobs.build-and-deploy"),(0,a.Uk)(" ，在一个 Action 中可以有多个 job，这是其中的一个，名称是自己取的；每个任务可以有多个 step；")]),(0,a._)("li",null,[(0,a._)("code",null,"jobs.build-and-deploy.steps[0]"),(0,a.Uk)(" ，用 "),(0,a._)("code",null,"actions/checkout"),(0,a.Uk)(" 检出仓库内容；")]),(0,a._)("li",null,[(0,a._)("code",null,"jobs.build-and-deploy.steps[1]"),(0,a.Uk)(" ，执行 "),(0,a._)("code",null,"npm"),(0,a.Uk)(" 命令安装开发环境；")]),(0,a._)("li",null,[(0,a._)("code",null,"jobs.build-and-deploy.steps[2]"),(0,a.Uk)(" ，用 "),(0,a._)("code",null,"JamesIves/github-pages-deploy-action"),(0,a.Uk)(" 部署 "),(0,a._)("code",null,"docs/.vuepress/dist"),(0,a.Uk)(" 文件夹中的内容到 "),(0,a._)("code",null,"gh-pages"),(0,a.Uk)(" 分支中。")])],-1),v=(0,a._)("p",null,"在编写好配置文件后可以提交并推送文件至 master 分支，这会自动触发 Action 的执行，并且你可以在 Actions 栏目中查看执行日志。",-1),A=(0,a._)("p",null,[(0,a._)("img",{src:t,alt:"image-20210824225724791"})],-1),P=(0,a._)("h2",{id:"配置-github-pages",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#配置-github-pages","aria-hidden":"true"},"#"),(0,a.Uk)(" 配置 Github Pages")],-1),j=(0,a._)("p",null,"我们的构建产物放在 gh-pages 分支，我们需要告诉 Github Pages 源文件位置。",-1),w=(0,a._)("p",null,"在 Github 仓库的 Settings 栏目中，从左侧的设置导航栏找到 Pages 设置。在这里你可以设置 gh-pages 为数据源。",-1),C=(0,a._)("p",null,[(0,a._)("img",{src:l,alt:"image-20210824230246146"})],-1),H=(0,a._)("p",null,"如果没出错的话，在配置完成之后你就可以通过 Github Pages 给你提供的域名来访问你的静态网站了。",-1),x=(0,a._)("hr",{class:"footnotes-sep"},null,-1),D={class:"footnotes"},I={class:"footnotes-list"},L={id:"fn1",class:"footnote-item"},V={href:"https://v2.vuepress.vuejs.org/zh/",target:"_blank",rel:"noopener noreferrer"},W=(0,a.Uk)("首页 | VuePress"),J=(0,a.Uk)(),M=(0,a._)("a",{href:"#fnref1",class:"footnote-backref"},"↩︎",-1),N={id:"fn2",class:"footnote-item"},T={href:"https://pages.github.com/",target:"_blank",rel:"noopener noreferrer"},z=(0,a.Uk)("GitHub Pages | Websites for you and your projects, hosted directly from your GitHub repository. Just edit, push, and your changes are live."),R=(0,a.Uk)(),O=(0,a._)("a",{href:"#fnref2",class:"footnote-backref"},"↩︎",-1),Y={id:"fn3",class:"footnote-item"},B={href:"https://docs.github.com/en/actions/learn-github-actions",target:"_blank",rel:"noopener noreferrer"},E=(0,a.Uk)("Learn GitHub Actions - GitHub Docs"),F=(0,a.Uk)(),S=(0,a._)("a",{href:"#fnref3",class:"footnote-backref"},"↩︎",-1),q={id:"fn4",class:"footnote-item"},K={href:"https://www.redhat.com/zh/topics/devops/what-is-ci-cd",target:"_blank",rel:"noopener noreferrer"},Q=(0,a.Uk)("什么是 CI/CD？一文带你理解 CI 持续集成和 CD 持续交付 / 部署 - 红帽"),X=(0,a.Uk)(),Z=(0,a._)("a",{href:"#fnref4",class:"footnote-backref"},"↩︎",-1),$={id:"fn5",class:"footnote-item"},nn={href:"https://github.com/JamesIves/github-pages-deploy-action",target:"_blank",rel:"noopener noreferrer"},en=(0,a.Uk)("JamesIves/github-pages-deploy-action: Automatically deploy your project to GitHub Pages using GitHub Actions. This action can be configured to push your production-ready code into any branch you'd like."),sn=(0,a.Uk)(),an=(0,a._)("a",{href:"#fnref5",class:"footnote-backref"},"↩︎",-1),tn={render:function(n,e){const s=(0,a.up)("OutboundLink");return(0,a.wg)(),(0,a.iD)(a.HY,null,[o,u,i,c,r,p,_,k,b,h,d,g,f,U,m,y,G,v,A,P,j,w,C,H,x,(0,a._)("section",D,[(0,a._)("ol",I,[(0,a._)("li",L,[(0,a._)("p",null,[(0,a._)("a",V,[W,(0,a.Wm)(s)]),J,M])]),(0,a._)("li",N,[(0,a._)("p",null,[(0,a._)("a",T,[z,(0,a.Wm)(s)]),R,O])]),(0,a._)("li",Y,[(0,a._)("p",null,[(0,a._)("a",B,[E,(0,a.Wm)(s)]),F,S])]),(0,a._)("li",q,[(0,a._)("p",null,[(0,a._)("a",K,[Q,(0,a.Wm)(s)]),X,Z])]),(0,a._)("li",$,[(0,a._)("p",null,[(0,a._)("a",nn,[en,(0,a.Wm)(s)]),sn,an])])])])],64)}}},1652:(n,e,s)=>{n.exports=s.p+"assets/img/image-20210824225724791.d9a5076a.png"},8867:(n,e,s)=>{n.exports=s.p+"assets/img/image-20210824230246146.7eacbfb5.png"}}]);