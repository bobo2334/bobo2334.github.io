"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4652],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return c}});var a=n(67294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=a.createContext({}),m=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=m(e.components);return a.createElement(o.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),u=m(n),c=l,k=u["".concat(o,".").concat(c)]||u[c]||s[c]||r;return n?a.createElement(k,i(i({ref:t},d),{},{components:n})):a.createElement(k,i({ref:t},d))}));function c(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=n.length,i=new Array(r);i[0]=u;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p.mdxType="string"==typeof e?e:l,i[1]=p;for(var m=2;m<r;m++)i[m]=n[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},26235:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return o},default:function(){return c},frontMatter:function(){return p},metadata:function(){return m},toc:function(){return s}});var a=n(83117),l=n(80102),r=(n(67294),n(3905)),i=["components"],p={},o="Spring MVC",m={unversionedId:"java/spring-mvc",id:"java/spring-mvc",title:"Spring MVC",description:"\u53c2\u8003\u8d44\u6599",source:"@site/docs/java/spring-mvc.md",sourceDirName:"java",slug:"/java/spring-mvc",permalink:"/docs/java/spring-mvc",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Spring Boot \u539f\u7406",permalink:"/docs/java/spring-boot.2"},next:{title:"Spring",permalink:"/docs/java/spring"}},d={},s=[{value:"\u53c2\u8003\u8d44\u6599",id:"\u53c2\u8003\u8d44\u6599",level:2},{value:"\u5feb\u901f\u5f00\u59cb",id:"\u5feb\u901f\u5f00\u59cb",level:2},{value:"\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u9879",id:"\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u9879",level:2},{value:"\u6ce8\u89e3",id:"\u6ce8\u89e3",level:2},{value:"@RequestMapping",id:"requestmapping",level:3},{value:"@RequestParam",id:"requestparam",level:3},{value:"@RequestBody",id:"requestbody",level:3},{value:"@RequestHeader",id:"requestheader",level:3},{value:"@PathVariable",id:"pathvariable",level:3},{value:"@CookieValue",id:"cookievalue",level:3},{value:"@ResponseBody",id:"responsebody",level:3},{value:"\u8bf7\u6c42\u53c2\u6570\u7ed1\u5b9a",id:"\u8bf7\u6c42\u53c2\u6570\u7ed1\u5b9a",level:2},{value:"\u539f\u751f Servlet \u7c7b\u578b",id:"\u539f\u751f-servlet-\u7c7b\u578b",level:3},{value:"\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c String \u7c7b\u578b",id:"\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c-string-\u7c7b\u578b",level:3},{value:"\u5b9e\u4f53\u7c7b\u578b",id:"\u5b9e\u4f53\u7c7b\u578b",level:3},{value:"\u6570\u636e\u5171\u4eab",id:"\u6570\u636e\u5171\u4eab",level:2},{value:"ModelAndView",id:"modelandview",level:3},{value:"Map",id:"map",level:3},{value:"Model",id:"model",level:3},{value:"ModelMap",id:"modelmap",level:3},{value:"\u8f6c\u53d1\u4e0e\u91cd\u5b9a\u5411",id:"\u8f6c\u53d1\u4e0e\u91cd\u5b9a\u5411",level:2},{value:"\u89c6\u56fe\u63a7\u5236\u5668",id:"\u89c6\u56fe\u63a7\u5236\u5668",level:2},{value:"HttpMessageConveter",id:"httpmessageconveter",level:2},{value:"\u6587\u4ef6\u4e0b\u8f7d",id:"\u6587\u4ef6\u4e0b\u8f7d",level:2},{value:"\u6587\u4ef6\u4e0a\u4f20",id:"\u6587\u4ef6\u4e0a\u4f20",level:2},{value:"\u8fc7\u6ee4\u5668",id:"\u8fc7\u6ee4\u5668",level:2},{value:"CharacterEncodingFilter",id:"characterencodingfilter",level:3},{value:"HiddenHttpMethodFilter",id:"hiddenhttpmethodfilter",level:3},{value:"\u62e6\u622a\u5668",id:"\u62e6\u622a\u5668",level:2},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406",level:2},{value:"HandlerExceptionResolver",id:"handlerexceptionresolver",level:3},{value:"SimpleMappingExceptionResolver",id:"simplemappingexceptionresolver",level:3},{value:"@ControllerAdvice",id:"controlleradvice",level:3},{value:"\u6ce8\u89e3\u914d\u7f6e Spring MVC",id:"\u6ce8\u89e3\u914d\u7f6e-spring-mvc",level:2},{value:"Spring MVC \u8fd0\u884c\u6d41\u7a0b",id:"spring-mvc-\u8fd0\u884c\u6d41\u7a0b",level:2},{value:"\u5f02\u6b65\u8bf7\u6c42",id:"\u5f02\u6b65\u8bf7\u6c42",level:2},{value:"Callable",id:"callable",level:3},{value:"DeferredResult",id:"deferredresult",level:3}],u={toc:s};function c(e){var t=e.components,p=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,a.Z)({},u,p,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"spring-mvc"},"Spring MVC"),(0,r.kt)("h2",{id:"\u53c2\u8003\u8d44\u6599"},"\u53c2\u8003\u8d44\u6599"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://mvnrepository.com/artifact/org.springframework/spring-web"},"Maven Repository: org.springframework \xbb spring-web")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://javadoc.io/doc/org.springframework/spring-web/latest/index.html"},"spring-web 5.2.7.RELEASE javadoc (org.springframework)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://javadoc.io/doc/org.springframework/spring-webmvc/latest/index.html"},"spring-webmvc 5.2.7.RELEASE javadoc (org.springframework)"))),(0,r.kt)("h2",{id:"\u5feb\u901f\u5f00\u59cb"},"\u5feb\u901f\u5f00\u59cb"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u521b\u5efa Maven \u5de5\u7a0b\uff0c\u5bfc\u5165\u4f9d\u8d56")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u914d\u7f6e",(0,r.kt)("inlineCode",{parentName:"p"},"web.xml"),"\uff0c\u5728 Tomcat \u5bb9\u5668\u5f00\u59cb\u8fd0\u884c\u65f6\u52a0\u8f7d SpringMVC \u7684 Servlet\u3002\u5e76\u4e14\u4f7f\u7528\u521d\u59cb\u5316\u53c2\u6570\u8bbe\u7f6e Spring \u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u4e4b\u540e\u518d\u628a",(0,r.kt)("inlineCode",{parentName:"p"},"DispatcherServlet"),"\u6620\u5c04\u5230\u6240\u6709\u8bf7\u6c42\u4e0a\uff0c\u6240\u6709\u8bf7\u6c42\u90fd\u7ecf\u8fc7\u6b64 Servlet \u5904\u7406\u3002\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff0c\u5219\u9ed8\u8ba4\u8def\u5f84\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"/WEB-INF/springMVC-{servlet-name}.xml"),"\uff0c\u5176\u4e2d",(0,r.kt)("inlineCode",{parentName:"p"},"servlet-name"),"\u662f\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"web.xml"),"\u4e2d\u914d\u7f6e\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"<servlet-name>"),"\u7684\u503c\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="web.xml"',title:'"web.xml"'},"<servlet>\n    <servlet-name>dispatcherServlet</servlet-name>\n    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n    <init-param>\n        <param-name>contextConfigLocation</param-name>\n        <param-value>classpath:mvc.xml</param-value>\n    </init-param>\n    <load-on-startup>0</load-on-startup>\n</servlet>\n\n<servlet-mapping>\n    <servlet-name>dispatcherServlet</servlet-name>\n    <url-pattern>/</url-pattern>\n</servlet-mapping>\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u914d\u7f6e Spring\uff0c\u5f00\u542f\u5305\u626b\u63cf\uff0c\u5f00\u542f\u6ce8\u89e3\u652f\u6301\uff0c\u5e76\u914d\u7f6e\u4e00\u4e2a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u6ce8\u5165\u53c2\u6570"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="applicationContext.xml"',title:'"applicationContext.xml"'},'<context:component-scan base-package="me.iuok"/>\n\n\x3c!--    \u6ce8\u89e3\u652f\u6301--\x3e\n<mvc:annotation-driven/>\n\n\x3c!--    \u89c6\u56fe\u89e3\u6790\u5668--\x3e\n<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">\n    <property name="prefix" value="/WEB-INF/pages/"/>\n    <property name="suffix" value=".jsp"/>\n</bean>\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u7f16\u5199 Controller\uff0c\u5904\u7406\u4e1a\u52a1\u903b\u8f91"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="HelloController.java"',title:'"HelloController.java"'},'@Slf4j\n@Controller\npublic class HelloController {\n\n    @RequestMapping("/hello")\n    public String sayHello() {\n        log.info("HelloController.sayHello");\n        return "success";\n    }\n\n}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5f53\u8bbf\u95ee ",(0,r.kt)("inlineCode",{parentName:"p"},"/hello")," \u7684\u65f6\u5019\u5c31\u4f1a\u663e\u793a ",(0,r.kt)("inlineCode",{parentName:"p"},"/WEB-INF/pages/success.jsp")," \u91cc\u7684\u5185\u5bb9\u4e86\u3002"))),(0,r.kt)("h2",{id:"\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u9879"},"\u914d\u7f6e\u6587\u4ef6\u914d\u7f6e\u9879"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"<mvc:default-servlet-handler/>"),"\u4f1a\u5728",(0,r.kt)("inlineCode",{parentName:"li"},"web.xml"),"\u4e2d\u5b9a\u4e49\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"li"},"DefaultServletHttpRequestHandler"),"\uff0c\u8def\u5f84\u662f",(0,r.kt)("inlineCode",{parentName:"li"},"/"),"\u3002\u7528\u6237\u914d\u7f6e\u7684",(0,r.kt)("inlineCode",{parentName:"li"},"DispatcherServlet"),"\u7684\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u5f53\u6536\u5230\u8bf7\u6c42\u65f6\u9996\u5148\u4ea4\u7ed9\u7528\u6237\u914d\u7f6e\u7684 Servlet \u8fdb\u884c\u5904\u7406\uff0c\u5982\u679c\u5904\u7406\u4e0d\u4e86\u518d\u4ea4\u7ed9\u9ed8\u8ba4\u7684\u3002\u6240\u4ee5\u8fd9\u4e2a Servlet \u80fd\u5904\u7406\u9759\u6001\u8d44\u6e90\u3002"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"<mvc:annotation-driven/>"),"\u5f00\u542f\u6ce8\u89e3\u626b\u63cf\u3002\u4e0d\u7136\u6ce8\u89e3\u4e0d\u751f\u6548\u3002")),(0,r.kt)("h2",{id:"\u6ce8\u89e3"},"\u6ce8\u89e3"),(0,r.kt)("h3",{id:"requestmapping"},"@RequestMapping"),(0,r.kt)("p",null,"\u53ef\u4ee5\u6807\u6ce8\u5728\u7c7b\u4e0a\u4e5f\u53ef\u4ee5\u6807\u6ce8\u5728\u65b9\u6cd5\u4e0a\uff0c\u5982\u679c\u6807\u6ce8\u5728\u7c7b\u4e0a\u5219\u6240\u6709\u7684\u65b9\u6cd5\u4e0a\u7684\u6620\u5c04\u7ee7\u627f\u7c7b\u4e0a\u7684\u6620\u5c04\u3002"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5c5e\u6027\u540d"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"),(0,r.kt)("th",{parentName:"tr",align:null},"\u793a\u4f8b"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"value")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"path"),"\u7684\u522b\u540d"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"path")),(0,r.kt)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u5efa\u7acb\u8bf7\u6c42 URL \u548c\u65b9\u6cd5\u4e4b\u95f4\u7684\u5173\u7cfb\u3002"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"method")),(0,r.kt)("td",{parentName:"tr",align:null},"\u9650\u5236\u8bf7\u6c42\u65b9\u5f0f"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"params")),(0,r.kt)("td",{parentName:"tr",align:null},"\u9650\u5236\u53c2\u6570"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"username"),"\u5fc5\u987b\u51fa\u73b0\u53c2\u6570\uff1b",(0,r.kt)("inlineCode",{parentName:"td"},"!username"),"\u4e0d\u80fd\u51fa\u73b0\u6b64\u53c2\u6570\uff1b",(0,r.kt)("inlineCode",{parentName:"td"},"username=who"),"\u9650\u5236\u53c2\u6570\u53d6\u503c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"headers")),(0,r.kt)("td",{parentName:"tr",align:null},"\u9650\u5236\u8bf7\u6c42\u5934\uff0c\u548c params \u7c7b\u4f3c"),(0,r.kt)("td",{parentName:"tr",align:null})))),(0,r.kt)("p",null,"Ant \u98ce\u683c\u8d44\u6e90\u5730\u5740\u5339\u914d\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"?"),"\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff1b"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"*"),"\u5339\u914d\u5355\u5c42\u8def\u5f84\uff1b"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"**"),"\u5339\u914d\u591a\u5c42\u8def\u5f84\u3002")),(0,r.kt)("h3",{id:"requestparam"},"@RequestParam"),(0,r.kt)("p",null,"\u53ea\u80fd\u6807\u6ce8\u5728\u65b9\u6cd5\u53c2\u6570\u4e0a\uff0c\u628a request \u4e2d\u7684\u8868\u5355\u53c2\u6570\u7ed1\u5b9a\u5230\u65b9\u6cd5\u53c2\u6570\u4e0a\u3002\u7528\u4e8e\u5728\u81ea\u52a8\u6ce8\u5165\u4e0d\u597d\u4f7f\u7684\u60c5\u51b5\u4e0b\uff0c\u65b9\u6cd5\u53c2\u6570\u540d\u79f0\u53ef\u4ee5\u548c\u8868\u5355\u53c2\u6570\u540d\u79f0\u4e0d\u76f8\u540c\u3002"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"\u5c5e\u6027\u540d"),(0,r.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"value")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"name"),"\u7684\u522b\u540d")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"name")),(0,r.kt)("td",{parentName:"tr",align:null},"\u53c2\u6570\u540d")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"required")),(0,r.kt)("td",{parentName:"tr",align:null},"\u662f\u5426\u5fc5\u987b\u6709\uff0c\u9ed8\u8ba4\u4e3a true\uff0c\u4e0d\u63d0\u4f9b\u5c31\u4f1a\u5f02\u5e38")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"defaultValue")),(0,r.kt)("td",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c")))),(0,r.kt)("h3",{id:"requestbody"},"@RequestBody"),(0,r.kt)("p",null,"\u6807\u6ce8\u5728\u65b9\u6cd5\u53c2\u6570\u4e0a\uff0c\u7528\u4e8e\u83b7\u53d6\u8bf7\u6c42\u4f53\u7684\u5185\u5bb9\uff0c\u6bd4\u5982\u4ee5 JSON \u683c\u5f0f\u4f20\u5165\u6570\u636e\u7684\u65f6\u5019\u3002GET \u65b9\u6cd5\u6ca1\u6709\u8bf7\u6c42\u4f53\uff0c\u6240\u4ee5\u4e0d\u9002\u7528\u3002"),(0,r.kt)("h3",{id:"requestheader"},"@RequestHeader"),(0,r.kt)("p",null,"\u6807\u6ce8\u5728\u65b9\u6cd5\u53c2\u6570\u4e0a\uff0c\u7528\u4e8e\u7ed1\u5b9a request \u4e2d\u7684 header \u503c\u3002"),(0,r.kt)("h3",{id:"pathvariable"},"@PathVariable"),(0,r.kt)("p",null,"\u6807\u6ce8\u5728\u65b9\u6cd5\u53c2\u6570\u4e0a\uff0c\u7528\u4e8e\u7ed1\u5b9a @RequestMapping \u8def\u5f84\u91cc\u7684\u53d8\u91cf\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/param/{id}")\npublic void pathVariable(@PathVariable("id") String id) {}\n')),(0,r.kt)("h3",{id:"cookievalue"},"@CookieValue"),(0,r.kt)("p",null,"\u6807\u6ce8\u5728\u65b9\u6cd5\u53c2\u6570\u4e0a\uff0c\u7528\u4e8e\u7ed1\u5b9a Cookie \u503c\u3002"),(0,r.kt)("h3",{id:"responsebody"},"@ResponseBody"),(0,r.kt)("p",null,"\u53ef\u4ee5\u6807\u6ce8\u5728\u7c7b\u4e0a\u548c\u65b9\u6cd5\u4e0a\uff0c\u53ef\u4ee5\u628a\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u76f4\u63a5\u8f93\u51fa\u5230 response\u3002"),(0,r.kt)("p",null,"\u5982\u679c\u8fd4\u56de\u503c\u662f\u5bf9\u8c61\u53ef\u4ee5\u81ea\u52a8\u8f6c\u4e3a json \u683c\u5f0f\u8f93\u51fa\uff0c\u9700\u8981\u5bfc\u5165 ",(0,r.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-databind"},"Jackson")," \u7684\u4f9d\u8d56\u3002"),(0,r.kt)("h2",{id:"\u8bf7\u6c42\u53c2\u6570\u7ed1\u5b9a"},"\u8bf7\u6c42\u53c2\u6570\u7ed1\u5b9a"),(0,r.kt)("p",null,"\u5728\u63a7\u5236\u5668\u65b9\u6cd5\u53c2\u6570\u5217\u8868\u91cc\u5199\u4e0a\u53c2\u6570\uff0cMVC \u5c31\u4f1a\u81ea\u52a8\u6ce8\u5165\u53c2\u6570\u3002"),(0,r.kt)("h3",{id:"\u539f\u751f-servlet-\u7c7b\u578b"},"\u539f\u751f Servlet \u7c7b\u578b"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"HttpServletRequest"),(0,r.kt)("li",{parentName:"ol"},"HttpServletResponse"),(0,r.kt)("li",{parentName:"ol"},"HttpSession"),(0,r.kt)("li",{parentName:"ol"},"java.security.Principal"),(0,r.kt)("li",{parentName:"ol"},"Locale"),(0,r.kt)("li",{parentName:"ol"},"InputStream"),(0,r.kt)("li",{parentName:"ol"},"OutputStream"),(0,r.kt)("li",{parentName:"ol"},"Reader"),(0,r.kt)("li",{parentName:"ol"},"Writer")),(0,r.kt)("h3",{id:"\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c-string-\u7c7b\u578b"},"\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c String \u7c7b\u578b"),(0,r.kt)("h3",{id:"\u5b9e\u4f53\u7c7b\u578b"},"\u5b9e\u4f53\u7c7b\u578b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"HttpEntity<>")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ResponseEntity<>")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"RequestEntity<>"))),(0,r.kt)("h2",{id:"\u6570\u636e\u5171\u4eab"},"\u6570\u636e\u5171\u4eab"),(0,r.kt)("h3",{id:"modelandview"},"ModelAndView"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/hello")\npublic ModelAndView test() {\n    ModelAndView modelAndView = new ModelAndView();\n    log.info("test \u65b9\u6cd5\u88ab\u6267\u884c");\n    modelAndView.addObject("msg", "\u4f60\u597d");\n    modelAndView.setViewName("test");\n    return modelAndView;\n}\n')),(0,r.kt)("h3",{id:"map"},"Map"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/map")\npublic String map(Map<String, Object> map) {\n    map.put("msg", "hello");\n    return "test";\n}\n')),(0,r.kt)("h3",{id:"model"},"Model"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/model")\npublic String map(String username, String password, Model model) {\n    model.addAttribute("username", username);\n    model.addAttribute("password", password);\n    return "charset";\n}\n')),(0,r.kt)("h3",{id:"modelmap"},"ModelMap"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/model")\npublic String map(String username, String password, ModelMap model) {\n    model.addAttribute("username", username);\n    model.addAttribute("password", password);\n    return "charset";\n}\n')),(0,r.kt)("h2",{id:"\u8f6c\u53d1\u4e0e\u91cd\u5b9a\u5411"},"\u8f6c\u53d1\u4e0e\u91cd\u5b9a\u5411"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'return "forward:/hello"\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'return "redirect:/index.jsp";\n')),(0,r.kt)("h2",{id:"\u89c6\u56fe\u63a7\u5236\u5668"},"\u89c6\u56fe\u63a7\u5236\u5668"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="applicationContext.xml"',title:'"applicationContext.xml"'},'<mvc:annotation-driven />\n\n\x3c!-- \u53ea\u8bbe\u7f6e\u4e0b\u9762\u8fd9\u4e00\u884c\u7684\u8bdd\uff0c\u901a\u8fc7\u6ce8\u89e3\u8bbe\u7f6e\u7684\u8def\u7531\u90fd\u4f1a\u5931\u6548 --\x3e\n<mvc:view-controller path="/testView" view-name="success" />\n')),(0,r.kt)("h2",{id:"httpmessageconveter"},"HttpMessageConveter"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(36264).Z,width:"1700",height:"628"})),(0,r.kt)("p",null,"\u8d1f\u8d23\u5c06\u8bf7\u6c42\u4fe1\u606f\u8f6c\u4e3a\u5bf9\u8c61\uff0c\u5c06\u5bf9\u8c61\u8f93\u51fa\u4e3a\u54cd\u5e94\u4fe1\u606f\u3002"),(0,r.kt)("p",null,"\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"HttpEntity<T>"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"ResponseEntity<T>"),"\u4f5c\u4e3a\u5904\u7406\u65b9\u6cd5\u7684\u5165\u53c2\u6216\u8fd4\u56de\u503c\u3002"),(0,r.kt)("h2",{id:"\u6587\u4ef6\u4e0b\u8f7d"},"\u6587\u4ef6\u4e0b\u8f7d"),(0,r.kt)("p",null,"\u8fd4\u56de\u503c\u7c7b\u578b",(0,r.kt)("inlineCode",{parentName:"p"},"ResponseEntity<byte []>"),"\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping("/testResponseEntity")\npublic ResponseEntity<byte[]> testResponseEntity(HttpSession session) throws IOException {\n    ServletContext servletContext = session.getServletContext();\n    InputStream resourceAsStream = servletContext.getResourceAsStream("/files/abc.txt");\n    byte[] body = new byte[resourceAsStream.available()];\n    resourceAsStream.read(body);\n    MultiValueMap<String, String> headers = new HttpHeaders();\n    headers.add("Content-Disposition", "attachment;filename=abc.txt");\n    HttpStatus statusCode = HttpStatus.OK;\n    return new ResponseEntity<byte[]>(body, headers, statusCode);\n}\n')),(0,r.kt)("h2",{id:"\u6587\u4ef6\u4e0a\u4f20"},"\u6587\u4ef6\u4e0a\u4f20"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u4e0a\u4f20\u8868\u5355\u8981\u6c42",(0,r.kt)("inlineCode",{parentName:"p"},'method="post"'),"\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},'enctype="multipart/form-data"')),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<form action="testUpload" method="post" enctype="multipart/form-data">\n    \u6587\u4ef6\uff1a<input type="file" name="file"/><br><br>\n    \u63cf\u8ff0\uff1a<input type="text" name="desc"/><br><br>\n    <input type="submit" value="\u63d0\u4ea4"/>\n</form>\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5bfc\u5165\u4f9d\u8d56"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload"},"Maven Repository: commons-fileupload \xbb commons-fileupload"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u914d\u7f6e",(0,r.kt)("inlineCode",{parentName:"p"},"multipartResolver"),"\uff0cid \u5fc5\u987b\u662f\u8fd9\u4e2a"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="applicationContext.xml"',title:'"applicationContext.xml"'},'<bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">\n    <property name="defaultEncoding" value="utf-8"/>\n    <property name="maxUploadSize" value="8888"/>\n</bean>\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5904\u7406"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping(value = "/upload", method = RequestMethod.POST)\npublic String upload(String desc, MultipartFile file) throws IOException {\n    file.transferTo(Paths.get(""));\n    return "test";\n}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u591a\u6587\u4ef6\u4e0a\u4f20\uff0c\u8868\u5355\u6539\u6210\u591a\u4e2a\u540c\u540d\u7684\u4e0a\u4f20\u57df"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@RequestMapping(value = "/upload", method = RequestMethod.POST)\npublic String upload(String desc, @RequestParam("file") MultipartFile[] files) throws IOException {\n    for (MultipartFile file : files) {\n        file.transferTo(Paths.get(""));\n    }\n    return "test";\n}\n')))),(0,r.kt)("h2",{id:"\u8fc7\u6ee4\u5668"},"\u8fc7\u6ee4\u5668"),(0,r.kt)("h3",{id:"characterencodingfilter"},"CharacterEncodingFilter"),(0,r.kt)("p",null,"\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u7528\u4e8e\u8bbe\u7f6e request \u548c response \u7684\u5b57\u7b26\u7f16\u7801\u3002\u5fc5\u987b\u9632\u6b62\u5728\u6240\u6709\u5176\u5b83\u8fc7\u6ee4\u5668\u4e4b\u524d\u3002\u4e0d\u7136\u5728 request \u88ab\u8bbf\u95ee\u4e4b\u540e\u518d\u8bbe\u7f6e\u5c31\u6ca1\u610f\u4e49\u4e86\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"forceEncoding"),"\u8bbe\u7f6e\u4e3a",(0,r.kt)("inlineCode",{parentName:"li"},"false"),"\u7684\u65f6\u5019\uff0c\u5982\u679c request \u672a\u8bbe\u7f6e\u5b57\u7b26\u96c6\u624d\u4f1a\u5bf9 request \u8bbe\u7f6e\u5b57\u7b26\u96c6\uff0c\u4e0d\u4f1a\u5bf9 response \u8bbe\u7f6e\u5b57\u7b26\u96c6\uff1b"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"forceEncoding"),"\u8bbe\u7f6e\u4e3a",(0,r.kt)("inlineCode",{parentName:"li"},"true"),"\u7684\u65f6\u5019\uff0c\u4efb\u4f55\u65f6\u5019\u90fd\u4f1a\u5bf9 request \u548c response \u8bbe\u7f6e\u5b57\u7b26\u96c6\u3002")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="web.xml"',title:'"web.xml"'},"<filter>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <filter-\nclass>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\n    <init-param>\n        <param-name>encoding</param-name>\n        <param-value>UTF-8</param-value>\n    </init-param>\n    <init-param>\n        <param-name>forceEncoding</param-name>\n        <param-value>true</param-value>\n    </init-param>\n</filter>\n<filter-mapping>\n    <filter-name>CharacterEncodingFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n")),(0,r.kt)("h3",{id:"hiddenhttpmethodfilter"},"HiddenHttpMethodFilter"),(0,r.kt)("p",null,"\u8fd9\u4e2a\u8fc7\u6ee4\u5668\u5904\u7406\u8bf7\u6c42\u53c2\u6570\u4e2d\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"_method"),"\u5b57\u6bb5\u3002\u6709\u4e9b\u5ba2\u6237\u7aef\u53ea\u80fd\u53d1\u9001 GET \u548c POST \u8bf7\u6c42\uff0c\u4e0d\u80fd\u53d1\u9001 DELETE \u6216 PUT \u8bf7\u6c42\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u7528\u4e8e\u544a\u77e5 Spring MVC \u6a21\u62df\u8bf7\u6c42\u65b9\u6cd5\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="web.xml"',title:'"web.xml"'},"<filter>\n    <filter-name>HiddenHttpMethodFilter</filter-name>\n    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-\nclass>\n</filter>\n<filter-mapping>\n    <filter-name>HiddenHttpMethodFilter</filter-name>\n    <url-pattern>/*</url-pattern>\n</filter-mapping>\n")),(0,r.kt)("h2",{id:"\u62e6\u622a\u5668"},"\u62e6\u622a\u5668"),(0,r.kt)("p",null,"\u7c7b\u4f3c\u4e8e Servlet \u4e2d\u7684\u8fc7\u6ee4\u5668\uff0c\u5bf9\u5904\u7406\u8fdb\u884c\u9884\u5904\u7406\u548c\u540e\u5904\u7406\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u7c7b\uff0c\u5b9e\u73b0",(0,r.kt)("inlineCode",{parentName:"p"},"HandlerIntercepter"),"\u63a5\u53e3\uff0c\u6216\u8005\u7ee7\u627f",(0,r.kt)("inlineCode",{parentName:"p"},"HandlerInterceptorAdapter"),"\uff0c\u91cd\u5199\u65b9\u6cd5\uff1b")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u914d\u7f6e\u6587\u4ef6\uff1b"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="applicationContext.xml"',title:'"applicationContext.xml"'},'\x3c!--    \u62e6\u622a\u5668--\x3e\n<mvc:interceptors>\n    <mvc:interceptor>\n        \x3c!--        \u8981\u62e6\u622a\u7684\u8def\u5f84--\x3e\n        <mvc:mapping path=""/>\n        \x3c!--        \u4e0d\u62e6\u622a\u7684\u8def\u5f84--\x3e\n        <mvc:exclude-mapping path=""/>\n        \x3c!--            \u62e6\u622a\u5668 Bean--\x3e\n        <bean class="" />\n    </mvc:interceptor>\n</mvc:interceptors>\n')))),(0,r.kt)("p",null,"\u62e6\u622a\u5668\u7684\u6267\u884c\u987a\u5e8f\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(3743).Z,width:"1604",height:"948"})),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"pre()"),(0,r.kt)("li",{parentName:"ol"},"controller"),(0,r.kt)("li",{parentName:"ol"},"post()"),(0,r.kt)("li",{parentName:"ol"},"xxx.jsp"),(0,r.kt)("li",{parentName:"ol"},"afterCompletion()")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:n(26620).Z,width:"1640",height:"892"})),(0,r.kt)("p",null,"\u5bf9\u4e8e\u591a\u4e2a\u62e6\u622a\u5668\u7684\u6267\u884c\u987a\u5e8f\u3002",(0,r.kt)("inlineCode",{parentName:"p"},"preHandle"),"\u662f\u987a\u5e8f\u6267\u884c\uff1b",(0,r.kt)("inlineCode",{parentName:"p"},"postHandle"),"\u662f\u5012\u5e8f\u6267\u884c\uff1b",(0,r.kt)("inlineCode",{parentName:"p"},"afterCompletion"),"\u4e5f\u662f\u5012\u5e8f\u6267\u884c\u3002"),(0,r.kt)("p",null,"\u5728\u6267\u884c",(0,r.kt)("inlineCode",{parentName:"p"},"preHandle"),"\u65f6\uff0c\u53ea\u8981\u9047\u5230\u4e00\u4e2a\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"\uff0c\u5269\u4e0b\u7684\u62e6\u622a\u5668\u90fd\u4e0d\u4f1a\u6267\u884c\u4e86\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"postHandle"),"\u90fd\u4e0d\u4f1a\u6267\u884c\u3002\u4f46\u662f\u8fd4\u56de",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"\u4e4b\u524d\u7684\u5176\u5b83\u62e6\u622a\u5668\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"afterCompletion"),"\u8fd8\u662f\u4f1a\u7ee7\u7eed\u6267\u884c\u3002"),(0,r.kt)("h2",{id:"\u5f02\u5e38\u5904\u7406"},"\u5f02\u5e38\u5904\u7406"),(0,r.kt)("h3",{id:"handlerexceptionresolver"},"HandlerExceptionResolver"),(0,r.kt)("p",null,"Controller \u8c03\u7528 Service\uff0cService \u8c03\u7528 DAO\uff0c\u5f02\u5e38\u90fd\u662f\u5411\u4e0a\u629b\u51fa\u7684\uff0c\u6700\u7ec8\u4ea4\u7531 DispatcherServlet \u8fdb\u884c\u5904\u7406\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u65b0\u7c7b\uff0c\u5b9e\u73b0 HandlerExceptionResolver\uff1b"),(0,r.kt)("li",{parentName:"ol"},"\u91cd\u5199\u65b9\u6cd5"),(0,r.kt)("li",{parentName:"ol"},"\u5728\u914d\u7f6e\u6587\u4ef6\u91cc\u914d\u7f6e bean")),(0,r.kt)("h3",{id:"simplemappingexceptionresolver"},"SimpleMappingExceptionResolver"),(0,r.kt)("p",null,"\u6216\u8005\u6709\u4e2a\u66f4\u7b80\u5355\u7684\u529e\u6cd5\uff0c\u81ea\u5e26\u7684\u6709\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"SimpleMappingExceptionResolver"),"\u3002\u53ef\u4ee5\u5feb\u6377\u5730\u5c06\u5f02\u5e38\u4e0e\u89c6\u56fe\u540d\u5bf9\u5e94\uff0c\u53d1\u751f\u5f02\u5e38\u65f6\u81ea\u52a8\u8df3\u8f6c\u5230\u5bf9\u5e94\u89c6\u56fe\uff0c\u5e26\u4e0a\u5f02\u5e38\u4fe1\u606f\uff0ckey \u662f",(0,r.kt)("inlineCode",{parentName:"p"},"exception"),"\u3002\u53ef\u4ee5\u628a\u6240\u6709\u5f02\u5e38\u4f5c\u4e00\u4e2a\u901a\u7528\u5904\u7406\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml",metastring:'title="applicationContext.xml"',title:'"applicationContext.xml"'},'<bean\nclass="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">\n    <property name="exceptionMappings">\n        <props>\n\x3c!-- properties \u7684\u952e\u8868\u793a\u5904\u7406\u5668\u65b9\u6cd5\u6267\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u5f02\u5e38 properties \u7684\u503c\u8868\u793a\u82e5\u51fa\u73b0\u6307\u5b9a\u5f02\u5e38\u65f6\uff0c\u8bbe\u7f6e\u4e00\u4e2a\u65b0\u7684\u89c6\u56fe\u540d\u79f0\uff0c\u8df3\u8f6c\u5230\u6307\u5b9a\u9875\u9762 --\x3e\n            <prop key="java.lang.ArithmeticException">error</prop>\n        </props>\n</property>\n\x3c!-- exceptionAttribute \u5c5e\u6027\u8bbe\u7f6e\u4e00\u4e2a\u5c5e\u6027\u540d\uff0c\u5c06\u51fa\u73b0\u7684\u5f02\u5e38\u4fe1\u606f\u5728\u8bf7\u6c42\u57df\u4e2d\u8fdb\u884c\u5171\u4eab --\x3e\n    <property name="exceptionAttribute" value="ex"></property>\n</bean>\n')),(0,r.kt)("h3",{id:"controlleradvice"},"@ControllerAdvice"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java",metastring:'title="ExceptionController.java"',title:'"ExceptionController.java"'},'@ControllerAdvice\npublic class ExceptionController {\n//@ExceptionHandler \u7528\u4e8e\u8bbe\u7f6e\u6240\u6807\u8bc6\u65b9\u6cd5\u5904\u7406\u7684\u5f02\u5e38\n@ExceptionHandler(ArithmeticException.class)\n//ex \u8868\u793a\u5f53\u524d\u8bf7\u6c42\u5904\u7406\u4e2d\u51fa\u73b0\u7684\u5f02\u5e38\u5bf9\u8c61\npublic String handleArithmeticException(Exception ex, Model model){\n        model.addAttribute("ex", ex);\n        return "error";\n    }\n}\n')),(0,r.kt)("h2",{id:"\u6ce8\u89e3\u914d\u7f6e-spring-mvc"},"\u6ce8\u89e3\u914d\u7f6e Spring MVC"),(0,r.kt)("p",null,"\u5728 Servlet 3.0 \u73af\u5883\u4e2d\uff0c\u5bb9\u5668\u4f1a\u5728\u7c7b\u8def\u5f84\u4e2d\u67e5\u627e\u5b9e\u73b0",(0,r.kt)("inlineCode",{parentName:"p"},"javax.servlet.ServletContainerInitializer"),"\u63a5\u53e3\u7684\u7c7b\uff0c\u5982\u679c\u627e\u5230\u7684\u8bdd\u5c31\u7528\u5b83\u6765\u914d\u7f6e Servlet \u5bb9\u5668\u3002Spring \u63d0\u4f9b\u4e86\u8fd9\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u540d\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"SpringServletContainerInitializer"),"\uff0c\u8fd9\u4e2a\u7c7b\u53cd\u8fc7\u6765\u53c8\u4f1a\u67e5\u627e\u5b9e\u73b0",(0,r.kt)("inlineCode",{parentName:"p"},"WebApplicationInitializer"),"\u7684\u7c7b\u5e76\u5c06\u914d\u7f6e\u7684\u4efb\u52a1\u4ea4\u7ed9\u5b83\u4eec\u6765\u5b8c\u6210\u3002Spring 3.2 \u5f15\u5165\u4e86\u4e00\u4e2a\u4fbf\u5229\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"WebApplicationInitializer"),"\u57fa\u7840\u5b9e\u73b0\uff0c\u540d\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"AbstractAnnotationConfigDispatcherServletInitializer"),"\uff0c\u5f53\u6211\u4eec\u7684\u7c7b\u6269\u5c55\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"AbstractAnnotationConfigDispatcherServletInitializer"),"\u5e76\u5c06\u5176\u90e8\u7f72\u5230 Servlet 3.0 \u5bb9\u5668\u7684\u65f6\u5019\uff0c\u5bb9\u5668\u4f1a\u81ea\u52a8\u53d1\u73b0\u5b83\uff0c\u5e76\u7528\u5b83\u6765\u914d\u7f6e Servlet \u4e0a\u4e0b\u6587\u3002"),(0,r.kt)("h2",{id:"spring-mvc-\u8fd0\u884c\u6d41\u7a0b"},"Spring MVC \u8fd0\u884c\u6d41\u7a0b"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image-20200712161734488",src:n(91423).Z,width:"862",height:"632"})),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u7528\u6237\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\uff0c\u8bf7\u6c42\u88ab SpringMVC \u524d\u7aef\u63a7\u5236\u5668 DispatcherServlet \u6355\u83b7\u3002"),(0,r.kt)("li",{parentName:"ol"},"DispatcherServlet \u5bf9\u8bf7\u6c42 URL \u8fdb\u884c\u89e3\u6790\uff0c\u5f97\u5230\u8bf7\u6c42\u8d44\u6e90\u6807\u8bc6\u7b26 (URI)\uff0c\u5224\u65ad\u8bf7\u6c42 URI \u5bf9\u5e94\u7684\u6620\u5c04\uff1a",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u4e0d\u5b58\u5728",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u518d\u5224\u65ad\u662f\u5426\u914d\u7f6e\u4e86 mvc:default-servlet-handler"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u6ca1\u914d\u7f6e\uff0c\u5219\u63a7\u5236\u53f0\u62a5\u6620\u5c04\u67e5\u627e\u4e0d\u5230\uff0c\u5ba2\u6237\u7aef\u5c55\u793a 404 \u9519\u8bef"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u6709\u914d\u7f6e\uff0c\u5219\u8bbf\u95ee\u76ee\u6807\u8d44\u6e90 (\u4e00\u822c\u4e3a\u9759\u6001\u8d44\u6e90\uff0c\u5982:JS\u3001CSS\u3001HTML)\uff0c\u627e\u4e0d\u5230\u5ba2\u6237\u7aef\u4e5f\u4f1a\u5c55\u793a 404 \u9519\u8bef"))),(0,r.kt)("li",{parentName:"ol"},"\u5b58\u5728\u5219\u6267\u884c\u4e0b\u9762\u7684\u6d41\u7a0b"))),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u8be5 URI\uff0c\u8c03\u7528 HandlerMapping \u83b7\u5f97\u8be5 Handler \u914d\u7f6e\u7684\u6240\u6709\u76f8\u5173\u7684\u5bf9\u8c61 (\u5305\u62ec Handler \u5bf9\u8c61\u4ee5\u53ca Handler \u5bf9\u8c61\u5bf9\u5e94\u7684\u62e6\u622a\u5668)\uff0c\u6700\u540e\u4ee5 HandlerExecutionChain \u6267\u884c\u94fe\u5bf9\u8c61\u7684\u5f62\u5f0f\u8fd4\u56de\u3002"),(0,r.kt)("li",{parentName:"ol"},"DispatcherServlet \u6839\u636e\u83b7\u5f97\u7684 Handler\uff0c\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684 HandlerAdapter\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5982\u679c\u6210\u529f\u83b7\u5f97 HandlerAdapter\uff0c\u6b64\u65f6\u5c06\u5f00\u59cb\u6267\u884c\u62e6\u622a\u5668\u7684 preHandler(...) \u65b9\u6cd5\u3010\u6b63\u5411\u3011"),(0,r.kt)("li",{parentName:"ol"},"\u63d0\u53d6 Request \u4e2d\u7684\u6a21\u578b\u6570\u636e\uff0c\u586b\u5145 Handler \u5165\u53c2\uff0c\u5f00\u59cb\u6267\u884c Handler(Controller) \u65b9\u6cd5\uff0c\u5904\u7406\u8bf7\u6c42\u3002\u5728\u586b\u5145 Handler \u7684\u5165\u53c2\u8fc7\u7a0b\u4e2d\uff0c\u6839\u636e\u4f60\u7684\u914d\u7f6e\uff0cSpring \u5c06\u5e2e\u4f60\u505a\u4e00\u4e9b\u989d\u5916\u7684\u5de5\u4f5c\uff1a",(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"HttpMessageConveter: \u5c06\u8bf7\u6c42\u6d88\u606f (\u5982 Json\u3001xml \u7b49\u6570\u636e) \u8f6c\u6362\u6210\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5c06\u5bf9\u8c61\u8f6c\u6362\u4e3a\u6307\u5b9a \u7684\u54cd\u5e94\u4fe1\u606f"),(0,r.kt)("li",{parentName:"ol"},"\u6570\u636e\u8f6c\u6362\uff1a\u5bf9\u8bf7\u6c42\u6d88\u606f\u8fdb\u884c\u6570\u636e\u8f6c\u6362\u3002\u5982 String \u8f6c\u6362\u6210 Integer\u3001Double \u7b49"),(0,r.kt)("li",{parentName:"ol"},"\u6570\u636e\u683c\u5f0f\u5316\uff1a\u5bf9\u8bf7\u6c42\u6d88\u606f\u8fdb\u884c\u6570\u636e\u683c\u5f0f\u5316\u3002\u5982\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u6210\u683c\u5f0f\u5316\u6570\u5b57\u6216\u683c\u5f0f\u5316\u65e5\u671f\u7b49 d) \u6570\u636e\u9a8c\u8bc1\uff1a\u9a8c\u8bc1\u6570\u636e\u7684\u6709\u6548\u6027 (\u957f\u5ea6\u3001\u683c\u5f0f\u7b49)\uff0c\u9a8c\u8bc1\u7ed3\u679c\u5b58\u50a8\u5230 BindingResult \u6216 Error \u4e2d"))),(0,r.kt)("li",{parentName:"ol"},"Handler \u6267\u884c\u5b8c\u6210\u540e\uff0c\u5411 DispatcherServlet \u8fd4\u56de\u4e00\u4e2a ModelAndView \u5bf9\u8c61\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6b64\u65f6\u5c06\u5f00\u59cb\u6267\u884c\u62e6\u622a\u5668\u7684 postHandle(...) \u65b9\u6cd5\u3010\u9006\u5411\u3011\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6839\u636e\u8fd4\u56de\u7684 ModelAndView(\u6b64\u65f6\u4f1a\u5224\u65ad\u662f\u5426\u5b58\u5728\u5f02\u5e38\uff1a\u5982\u679c\u5b58\u5728\u5f02\u5e38\uff0c\u5219\u6267\u884c HandlerExceptionResolver \u8fdb\u884c\u5f02\u5e38\u5904\u7406) \u9009\u62e9\u4e00\u4e2a\u9002\u5408\u7684 ViewResolver \u8fdb\u884c\u89c6\u56fe\u89e3\u6790\uff0c\u6839\u636e Model \u548c View\uff0c\u6765\u6e32\u67d3\u89c6\u56fe\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u6e32\u67d3\u89c6\u56fe\u5b8c\u6bd5\u6267\u884c\u62e6\u622a\u5668\u7684 afterCompletion(...) \u65b9\u6cd5\u3010\u9006\u5411\u3011\u3002"),(0,r.kt)("li",{parentName:"ol"},"\u5c06\u6e32\u67d3\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002")),(0,r.kt)("h2",{id:"\u5f02\u6b65\u8bf7\u6c42"},"\u5f02\u6b65\u8bf7\u6c42"),(0,r.kt)("p",null,"Servlet 3.0 \u4e2d\u7684\u5f02\u6b65\u8bf7\u6c42\u5728 SpringMVC \u91cc\u4e5f\u4f5c\u4e86\u652f\u6301\u3002\u6709\u4e24\u79cd\u65b9\u5f0f\u5b9e\u73b0\u5f02\u6b65\u8bf7\u6c42\u3002"),(0,r.kt)("h3",{id:"callable"},"Callable"),(0,r.kt)("p",null,"\u63a7\u5236\u5668\u8fd4\u56de\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"Callable"),"\u5bf9\u8c61\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/callable")\npublic Callable<String> callable() {\n    log.info(Thread.currentThread().getName());\n\n    return () -> {\n        log.info(Thread.currentThread().getName());\n        return "\u4f60\u597d";\n    };\n}\n')),(0,r.kt)("h3",{id:"deferredresult"},"DeferredResult"),(0,r.kt)("p",null,"\u63a7\u5236\u5668\u8fd4\u56de\u4e00\u4e2a",(0,r.kt)("inlineCode",{parentName:"p"},"DeferredResult"),"\u5bf9\u8c61\uff0c\u7136\u540e\u5728\u5176\u4ed6\u7ebf\u7a0b\u4e2d\u7b49\u5f85\u4efb\u52a1\u5b8c\u6210\u7684\u65f6\u5019\u8c03\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"setResult()"),"\u65b9\u6cd5\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'@GetMapping("/deferredResult")\npublic DeferredResult<String> deferredResult() {\n    DeferredResult<String> deferredResult = new DeferredResult<>();\n    processDeferredResult(deferredResult);\n    log.info("AsyncController.deferredResult");\n    log.info(Thread.currentThread().getName());\n    return deferredResult;\n}\n\nprivate void processDeferredResult(DeferredResult<String> deferredResult) {\n    new Thread(() -> {\n        try {\n            Thread.sleep(2000);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        deferredResult.setResult("Hello");\n        log.info("AsyncController.processDeferredResult");\n        log.info(Thread.currentThread().getName());\n    }).start();\n}\n')))}c.isMDXComponent=!0},91423:function(e,t,n){t.Z=n.p+"assets/images/image-20200712161734488-4e08f231692306b50942f727000e6ce4.png"},3743:function(e,t,n){t.Z=n.p+"assets/images/wpsCwUu8t-a20f263587e7b12528c194ac3db39429.jpg"},26620:function(e,t,n){t.Z=n.p+"assets/images/wpsOCuYKk-67c8e2fdc24a7ba9bdc26a54a91c19c4.jpg"},36264:function(e,t,n){t.Z=n.p+"assets/images/wpsuwWczF-1ee0dfdf81510f93aaa275e5715ce13f.jpg"}}]);