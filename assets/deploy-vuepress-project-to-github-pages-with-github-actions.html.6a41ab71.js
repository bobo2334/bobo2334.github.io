import{r as n,o as s,c as e,a,b as t,F as l,e as o}from"./app.c5cba7ed.js";const u={},i=a("h1",{id:"利用-github-actions-部署-vuepress-项目到-github-pages",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#利用-github-actions-部署-vuepress-项目到-github-pages","aria-hidden":"true"},"#"),o(" 利用 Github Actions 部署 Vuepress 项目到 Github Pages")],-1),c=a("h2",{id:"前言",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),o(" 前言")],-1),r=a("p",null,[o("Vuepress"),a("sup",{class:"footnote-ref"},[a("a",{href:"#fn1",id:"fnref1"},"[1]")]),o(" 是一个基于 Vue 的静态网站生成器；Github Pages"),a("sup",{class:"footnote-ref"},[a("a",{href:"#fn2",id:"fnref2"},"[2]")]),o(" 是 Github 提供的免费的静态网站托管服务；Github Actions"),a("sup",{class:"footnote-ref"},[a("a",{href:"#fn3",id:"fnref3"},"[3]")]),o(" 是 Github 仓库中集成的 CI/CD"),a("sup",{class:"footnote-ref"},[a("a",{href:"#fn4",id:"fnref4"},"[4]")]),o(" 服务。")],-1),p=a("p",null,"Vuepress 是一个 Node.js 项目，它可以根据配置将 Markdown 文件转为 HTML 文件。你可以将输出的静态文件托管在 Github Pages 中，这样你就得到了一个可以访问的域名来展示这些静态的 HTML 文件。",-1),b=a("p",null,"传统的做法是在本地安装好 Noed.js 环境，自己手动构建项目之后将构建产物上传到 Github 仓库，从而触发 Github Pages 的构建。现在可以利用 Github Actions 来代替手工劳动，Github Actions 可以自动被触发，它运行在 Github 提供的虚拟环境中，可以执行一系列任务从而代替重复枯燥的手动构建和部署的步骤。",-1),h=a("h2",{id:"创建-github-仓库",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#创建-github-仓库","aria-hidden":"true"},"#"),o(" 创建 Github 仓库")],-1),d=a("p",null,"在创建的 Github 仓库时要注意仓库名称，假如你的用户名是 foo。",-1),f=a("p",null,[o("如果你创建了一个名为 "),a("code",null,"foo.github.io"),o(" 的仓库，你将可以通过 "),a("code",null,"https://foo.github.io"),o(" 来访问此仓库的 Github Pages 内容；")],-1),k=a("p",null,[o("如果你创建其他名称的仓库如 "),a("code",null,"bar"),o(" ，你可以通过 "),a("code",null,"https://foo.github.io/bar/"),o(" 来访问此仓库的 Github Pages 内容。")],-1),g=a("p",null,"你可以根据你期望的访问方式来选择仓库名称。",-1),m=a("h2",{id:"配置-github-actions",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#配置-github-actions","aria-hidden":"true"},"#"),o(" 配置 Github Actions")],-1),y=a("p",null,[o("Github Actions 的配置文件应该放在项目根目录下的 "),a("code",null,".github/workflows/"),o(" 文件夹中，你可以在一个项目中配置多个 Actions。配置文件是 YAML 格式，文件名形如 "),a("code",null,"*.yml"),o(" 。")],-1),G=a("p",null,[o("每一个 Action 中可以包括多个 job，每个 job 可以包括多个 step。在 step 中你可以直接运行命令，或者引用其他人编写好的 Action 脚本。在本文的配置文件中，我们引用了 github-pages-deploy-action"),a("sup",{class:"footnote-ref"},[a("a",{href:"#fn5",id:"fnref5"},"[5]")]),o(" 来完成 Github Pages 部署，而不用关系其实现细节。")],-1),A=a("p",null,"完成本文目标的 Github Actions 配置文件内容如下。",-1),v=a("div",{class:"language-yaml ext-yml line-numbers-mode"},[a("pre",{class:"language-yaml"},[a("code",null,[a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),o(),a("span",{class:"token string"},'"github actions build and deploy gh-pages"'),o("\n"),a("span",{class:"token key atrule"},"on"),a("span",{class:"token punctuation"},":"),o("\n  "),a("span",{class:"token key atrule"},"push"),a("span",{class:"token punctuation"},":"),o("\n    "),a("span",{class:"token key atrule"},"branches"),a("span",{class:"token punctuation"},":"),o("\n      "),a("span",{class:"token punctuation"},"-"),o(" master\n"),a("span",{class:"token key atrule"},"jobs"),a("span",{class:"token punctuation"},":"),o("\n  "),a("span",{class:"token key atrule"},"build-and-deploy"),a("span",{class:"token punctuation"},":"),o("\n    "),a("span",{class:"token key atrule"},"runs-on"),a("span",{class:"token punctuation"},":"),o(" ubuntu"),a("span",{class:"token punctuation"},"-"),o("latest\n    "),a("span",{class:"token key atrule"},"steps"),a("span",{class:"token punctuation"},":"),o("\n      "),a("span",{class:"token punctuation"},"-"),o(),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),o(" Checkout\n        "),a("span",{class:"token key atrule"},"uses"),a("span",{class:"token punctuation"},":"),o(" actions/checkout@v2.3.1\n        "),a("span",{class:"token key atrule"},"with"),a("span",{class:"token punctuation"},":"),o("\n          "),a("span",{class:"token key atrule"},"persist-credentials"),a("span",{class:"token punctuation"},":"),o(),a("span",{class:"token boolean important"},"false"),o("\n      "),a("span",{class:"token punctuation"},"-"),o(),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),o(" install and build\n        "),a("span",{class:"token key atrule"},"run"),a("span",{class:"token punctuation"},":"),o(),a("span",{class:"token punctuation"},"|"),a("span",{class:"token scalar string"},"\n          npm install\n          npm run build"),o("\n      "),a("span",{class:"token punctuation"},"-"),o(),a("span",{class:"token key atrule"},"name"),a("span",{class:"token punctuation"},":"),o(" Deploy\n        "),a("span",{class:"token key atrule"},"uses"),a("span",{class:"token punctuation"},":"),o(" JamesIves/github"),a("span",{class:"token punctuation"},"-"),o("pages"),a("span",{class:"token punctuation"},"-"),o("deploy"),a("span",{class:"token punctuation"},"-"),o("action@4.1.4\n        "),a("span",{class:"token key atrule"},"with"),a("span",{class:"token punctuation"},":"),o("\n          "),a("span",{class:"token key atrule"},"BRANCH"),a("span",{class:"token punctuation"},":"),o(" gh"),a("span",{class:"token punctuation"},"-"),o("pages\n          "),a("span",{class:"token key atrule"},"FOLDER"),a("span",{class:"token punctuation"},":"),o(" docs/.vuepress/dist\n")])]),a("div",{class:"line-numbers"},[a("span",{class:"line-number"},"1"),a("br"),a("span",{class:"line-number"},"2"),a("br"),a("span",{class:"line-number"},"3"),a("br"),a("span",{class:"line-number"},"4"),a("br"),a("span",{class:"line-number"},"5"),a("br"),a("span",{class:"line-number"},"6"),a("br"),a("span",{class:"line-number"},"7"),a("br"),a("span",{class:"line-number"},"8"),a("br"),a("span",{class:"line-number"},"9"),a("br"),a("span",{class:"line-number"},"10"),a("br"),a("span",{class:"line-number"},"11"),a("br"),a("span",{class:"line-number"},"12"),a("br"),a("span",{class:"line-number"},"13"),a("br"),a("span",{class:"line-number"},"14"),a("br"),a("span",{class:"line-number"},"15"),a("br"),a("span",{class:"line-number"},"16"),a("br"),a("span",{class:"line-number"},"17"),a("br"),a("span",{class:"line-number"},"18"),a("br"),a("span",{class:"line-number"},"19"),a("br"),a("span",{class:"line-number"},"20"),a("br"),a("span",{class:"line-number"},"21"),a("br"),a("span",{class:"line-number"},"22"),a("br")])],-1),j=a("p",null,"其中的一些关键配置解释如下。",-1),P=a("ul",null,[a("li",null,[a("code",null,"on.push.branches"),o(" ，在推送到 "),a("code",null,"master"),o(" 分支时触发此 Action；")]),a("li",null,[a("code",null,"jobs.build-and-deploy"),o(" ，在一个 Action 中可以有多个 job，这是其中的一个，名称是自己取的；每个任务可以有多个 step；")]),a("li",null,[a("code",null,"jobs.build-and-deploy.steps[0]"),o(" ，用 "),a("code",null,"actions/checkout"),o(" 检出仓库内容；")]),a("li",null,[a("code",null,"jobs.build-and-deploy.steps[1]"),o(" ，执行 "),a("code",null,"npm"),o(" 命令安装开发环境；")]),a("li",null,[a("code",null,"jobs.build-and-deploy.steps[2]"),o(" ，用 "),a("code",null,"JamesIves/github-pages-deploy-action"),o(" 部署 "),a("code",null,"docs/.vuepress/dist"),o(" 文件夹中的内容到 "),a("code",null,"gh-pages"),o(" 分支中。")])],-1),w=a("p",null,"在编写好配置文件后可以提交并推送文件至 master 分支，这会自动触发 Action 的执行，并且你可以在 Actions 栏目中查看执行日志。",-1),H=a("p",null,[a("img",{src:"/assets/image-20210824225724791.e3e482cb.png",alt:"image-20210824225724791"})],-1),C=a("h2",{id:"配置-github-pages",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#配置-github-pages","aria-hidden":"true"},"#"),o(" 配置 Github Pages")],-1),x=a("p",null,"我们的构建产物放在 gh-pages 分支，我们需要告诉 Github Pages 源文件位置。",-1),I=a("p",null,"在 Github 仓库的 Settings 栏目中，从左侧的设置导航栏找到 Pages 设置。在这里你可以设置 gh-pages 为数据源。",-1),D=a("p",null,[a("img",{src:"/assets/image-20210824230246146.ae98c08e.png",alt:"image-20210824230246146"})],-1),L=a("p",null,"如果没出错的话，在配置完成之后你就可以通过 Github Pages 给你提供的域名来访问你的静态网站了。",-1),J=a("hr",{class:"footnotes-sep"},null,-1),V={class:"footnotes"},_={class:"footnotes-list"},M={id:"fn1",class:"footnote-item"},N={href:"https://v2.vuepress.vuejs.org/zh/",target:"_blank",rel:"noopener noreferrer"},T=o("首页 | VuePress"),z=o(),F=a("a",{href:"#fnref1",class:"footnote-backref"},"↩︎",-1),O={id:"fn2",class:"footnote-item"},R={href:"https://pages.github.com/",target:"_blank",rel:"noopener noreferrer"},B=o("GitHub Pages | Websites for you and your projects, hosted directly from your GitHub repository. Just edit, push, and your changes are live."),E=o(),S=a("a",{href:"#fnref2",class:"footnote-backref"},"↩︎",-1),W={id:"fn3",class:"footnote-item"},Y={href:"https://docs.github.com/en/actions/learn-github-actions",target:"_blank",rel:"noopener noreferrer"},q=o("Learn GitHub Actions - GitHub Docs"),K=o(),Q=a("a",{href:"#fnref3",class:"footnote-backref"},"↩︎",-1),U={id:"fn4",class:"footnote-item"},X={href:"https://www.redhat.com/zh/topics/devops/what-is-ci-cd",target:"_blank",rel:"noopener noreferrer"},Z=o("什么是 CI/CD？一文带你理解 CI 持续集成和 CD 持续交付 / 部署 - 红帽"),$=o(),nn=a("a",{href:"#fnref4",class:"footnote-backref"},"↩︎",-1),sn={id:"fn5",class:"footnote-item"},en={href:"https://github.com/JamesIves/github-pages-deploy-action",target:"_blank",rel:"noopener noreferrer"},an=o("JamesIves/github-pages-deploy-action: Automatically deploy your project to GitHub Pages using GitHub Actions. This action can be configured to push your production-ready code into any branch you'd like."),tn=o(),ln=a("a",{href:"#fnref5",class:"footnote-backref"},"↩︎",-1);u.render=function(o,u){const on=n("OutboundLink");return s(),e(l,null,[i,c,r,p,b,h,d,f,k,g,m,y,G,A,v,j,P,w,H,C,x,I,D,L,J,a("section",V,[a("ol",_,[a("li",M,[a("p",null,[a("a",N,[T,t(on)]),z,F])]),a("li",O,[a("p",null,[a("a",R,[B,t(on)]),E,S])]),a("li",W,[a("p",null,[a("a",Y,[q,t(on)]),K,Q])]),a("li",U,[a("p",null,[a("a",X,[Z,t(on)]),$,nn])]),a("li",sn,[a("p",null,[a("a",en,[an,t(on)]),tn,ln])])])])],64)};export{u as default};
