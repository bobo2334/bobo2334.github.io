<!doctype html>
<html lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="我的学习笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="我的学习笔记 Atom Feed">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><title data-react-helmet="true">开启 Docker Remote API 并启用 TLS | 我的学习笔记</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://iuok.me/blog/enable-docker-remote-api-with-tls-protection"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" name="msapplication-TileColor" contnet="#da532c"><meta data-react-helmet="true" name="theme-color" contnet="#25c2a0"><meta data-react-helmet="true" property="og:title" content="开启 Docker Remote API 并启用 TLS | 我的学习笔记"><meta data-react-helmet="true" name="description" content="前言"><meta data-react-helmet="true" property="og:description" content="前言"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-09-09T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="docker"><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://iuok.me/blog/enable-docker-remote-api-with-tls-protection"><link data-react-helmet="true" rel="alternate" href="https://iuok.me/blog/enable-docker-remote-api-with-tls-protection" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://iuok.me/blog/enable-docker-remote-api-with-tls-protection" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.2e1fad83.css">
<link rel="preload" href="/assets/js/runtime~main.9976181a.js" as="script">
<link rel="preload" href="/assets/js/main.d048cc3c.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/android-chrome-512x512.png" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/android-chrome-512x512.png" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">我的学习笔记</b></a><a class="navbar__item navbar__link" href="/docs/bookmarks/interesting-projects">笔记</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">文章</a><a class="navbar__item navbar__link" href="/blog/archive">文章归档</a><a class="navbar__item navbar__link" href="/blog/tags">文章标签</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bobo2334/bobo2334.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">最新文章</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/mount-tencent-cos-on-local-file-system">挂载腾讯云 COS 到本地文件夹</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/activate-windows-and-office-with-kms">用 KMS 激活 Windows 和 Office</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/self-hosted-zerotier-controller">自建 Zerotier 行星节点</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/ufw">UFW：简单易上手的防火墙规则管理工具</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/debian-environment-backup">Debian 配置备份</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">开启 Docker Remote API 并启用 TLS</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-09-09T00:00:00.000Z" itemprop="datePublished">2021年9月9日</time></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="前言">前言<a aria-hidden="true" class="hash-link" href="#前言" title="Direct link to heading">​</a></h2><p>Portainer<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> 是一款 Docker 可视化管理面板，它不仅可以管理本地的 Docker 实例，还可以通过 Docker Remote API 访问管理远程 Docker 资源。Docker Remote API 就是通过 HTTP 协议暴露 Docker 资源，启用 TLS 可以实现远程访问鉴权。</p><p>Docker 的官方文档提供了详细的开启 Docker Remote API 和开启 TLS 的教程 <sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>。但是在签发证书的过程中涉及到的命令比较多，且繁琐，我就从网络上寻找到了别人写好的签发证书的脚本 <sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup>，可以很方便地替代纯手工操作。</p><p>本文中的操作都在 CentOS 7 中完成。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="签发证书">签发证书<a aria-hidden="true" class="hash-link" href="#签发证书" title="Direct link to heading">​</a></h2><p>将脚本命名为<code>auto-tls-certs.sh</code>。其中需要配置的内容有：</p><ol><li><code>CODE</code>，作为文件名的后缀，用于区分文件；</li><li><code>IP</code>，机器的公网 IP 地址；</li><li><code>PASSWORD</code>，证书密码。</li></ol><p>脚本内容如下：</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 自动创建 Docker TLS 证书</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 以下是配置信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># --[BEGIN]------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CODE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;tx&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">IP</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;1.1.1.1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PASSWORD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;pass&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">COUNTRY</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;CN&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">STATE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;BEIJING&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CITY</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;BEIJING&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ORGANIZATION</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Org&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ORGANIZATIONAL_UNIT</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Dev&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">COMMON_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$IP</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">EMAIL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># --[END]--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate CA key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -aes256 -passout </span><span class="token string" style="color:#e3116c">&quot;pass:</span><span class="token string variable" style="color:#36acaa">$PASSWORD</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -out </span><span class="token string" style="color:#e3116c">&quot;ca-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate CA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -new -x509 -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -key </span><span class="token string" style="color:#e3116c">&quot;ca-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -sha256 -out </span><span class="token string" style="color:#e3116c">&quot;ca-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -passin </span><span class="token string" style="color:#e3116c">&quot;pass:</span><span class="token string variable" style="color:#36acaa">$PASSWORD</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -subj </span><span class="token string" style="color:#e3116c">&quot;/C=</span><span class="token string variable" style="color:#36acaa">$COUNTRY</span><span class="token string" style="color:#e3116c">/ST=</span><span class="token string variable" style="color:#36acaa">$STATE</span><span class="token string" style="color:#e3116c">/L=</span><span class="token string variable" style="color:#36acaa">$CITY</span><span class="token string" style="color:#e3116c">/O=</span><span class="token string variable" style="color:#36acaa">$ORGANIZATION</span><span class="token string" style="color:#e3116c">/OU=</span><span class="token string variable" style="color:#36acaa">$ORGANIZATIONAL_UNIT</span><span class="token string" style="color:#e3116c">/CN=</span><span class="token string variable" style="color:#36acaa">$COMMON_NAME</span><span class="token string" style="color:#e3116c">/emailAddress=</span><span class="token string variable" style="color:#36acaa">$EMAIL</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Server key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -out </span><span class="token string" style="color:#e3116c">&quot;server-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Server Certs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -subj </span><span class="token string" style="color:#e3116c">&quot;/CN=</span><span class="token string variable" style="color:#36acaa">$COMMON_NAME</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -sha256 -new -key </span><span class="token string" style="color:#e3116c">&quot;server-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -out server.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;subjectAltName = IP:</span><span class="token string variable" style="color:#36acaa">$IP</span><span class="token string" style="color:#e3116c">,IP:127.0.0.1&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> extfile.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;extendedKeyUsage = serverAuth&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> extfile.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -sha256 -in server.csr -passin </span><span class="token string" style="color:#e3116c">&quot;pass:</span><span class="token string variable" style="color:#36acaa">$PASSWORD</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -CA </span><span class="token string" style="color:#e3116c">&quot;ca-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -CAkey </span><span class="token string" style="color:#e3116c">&quot;ca-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -CAcreateserial -out </span><span class="token string" style="color:#e3116c">&quot;server-cert-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -extfile extfile.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Client Certs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> -f extfile.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa -out </span><span class="token string" style="color:#e3116c">&quot;key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req -subj </span><span class="token string" style="color:#e3116c">&#x27;/CN=client&#x27;</span><span class="token plain"> -new -key </span><span class="token string" style="color:#e3116c">&quot;key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -out client.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> extendedKeyUsage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> clientAuth </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> extfile.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 -req -days </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> -sha256 -in client.csr -passin </span><span class="token string" style="color:#e3116c">&quot;pass:</span><span class="token string variable" style="color:#36acaa">$PASSWORD</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> -CA </span><span class="token string" style="color:#e3116c">&quot;ca-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -CAkey </span><span class="token string" style="color:#e3116c">&quot;ca-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -CAcreateserial -out </span><span class="token string" style="color:#e3116c">&quot;cert-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> -extfile extfile.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> -vf client.csr server.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -v 0400 </span><span class="token string" style="color:#e3116c">&quot;ca-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -v 0444 </span><span class="token string" style="color:#e3116c">&quot;ca-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server-cert-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cert-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 打包客户端证书</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p </span><span class="token string" style="color:#e3116c">&quot;tls-client-certs-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> -f </span><span class="token string" style="color:#e3116c">&quot;ca-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cert-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tls-client-certs-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tls-client-certs-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> zcf </span><span class="token string" style="color:#e3116c">&quot;tls-client-certs-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.tar.gz&quot;</span><span class="token plain"> *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tls-client-certs-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.tar.gz&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> -rf </span><span class="token string" style="color:#e3116c">&quot;tls-client-certs-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 拷贝服务端证书</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> -p /etc/docker/certs.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ca-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server-cert-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;server-key-</span><span class="token string variable" style="color:#36acaa">$CODE</span><span class="token string" style="color:#e3116c">.pem&quot;</span><span class="token plain"> /etc/docker/certs.d/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>使用<code>sh auto-tls-certs.sh</code>命令来生成证书，并且生成好的证书会被自动打包为<code>.tar.gz</code>归档，非常方便。下面的图片展示了执行脚本后生成的文件列表。</p><p><img alt="image-20210816222131111-16291236956091" src="/assets/images/image-20210816222131111-16291236956091-ba65ff370246e82306b56935a27bed2c.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="配置-docker">配置 Docker<a aria-hidden="true" class="hash-link" href="#配置-docker" title="Direct link to heading">​</a></h2><p>只需关注<code>.pem</code>文件，把证书找个专门的位置存放。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> /etc/.docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> ~/docker-cert/*.pem /etc/.docker/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>修改 Docker 启动文件。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">nano</span><span class="token plain"> /lib/systemd/system/docker.service</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>修改<code>Service</code>下的<code>ExecStart</code>配置。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI systemd"><pre tabindex="0" class="prism-code language-systemd codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock -D -H tcp://0.0.0.0:2376 --tlsverify --tlscacert=/etc/.docker/ca-tx.pem --tlscert=/etc/.docker/server-cert-tx.pem --tlskey=/etc/.docker/server-key-tx.pem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image-20210816222434122-16291238760702" src="/assets/images/image-20210816222434122-16291238760702-44ce2afe0e7f335aa9bb115c4c7cff40.png"></p><p>重启 Docker。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reloadservice docker restart</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="开放端口">开放端口<a aria-hidden="true" class="hash-link" href="#开放端口" title="Direct link to heading">​</a></h2><p>在防火墙、安全组中放行 2376 端口。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="测试">测试<a aria-hidden="true" class="hash-link" href="#测试" title="Direct link to heading">​</a></h2><p>把证书的压缩包<code>tls-client-certs-tx.tar.gz</code>下载到本机，解压得到证书文件。</p><p><img alt="image-20210816222527037" src="data:image/png;base64,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"></p><p>用<code>curl</code>命令测试，如果有 JSON 格式的信息输出则配置成功。</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> https://你的 IP/info --cert cert-tx.pem --key key-tx.pem --cacert ca-tx.pem</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="image-20210816222600935-16291239626163" src="/assets/images/image-20210816222600935-16291239626163-553b178f7586fc8a90c65e3eedb03eed.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="用-portainer-连接">用 Portainer 连接<a aria-hidden="true" class="hash-link" href="#用-portainer-连接" title="Direct link to heading">​</a></h2><p>Portainer 是一款非常好用的 Docker 可视化管理工具，通过暴露 Docker Remote API 可以远程连接并管理 Docker 资源。</p><p>在<code>Endpoints</code>页面中点击<code>Add endpoint</code>，<code>Environment type</code>选择<code>Docker</code>。</p><p>在对应的输入框中填写 IP 地址和端口号，开启 TLS，选择三个对应的证书文件。</p><p><img alt="image-20210816222733033-16291240547284" src="/assets/images/image-20210816222733033-16291240547284-a48b6576bf253c03858fa23a69261598.png"></p><div class="footnotes"><hr><ol><li id="fn-1"><a href="https://documentation.portainer.io/" target="_blank" rel="noopener noreferrer">Documentation</a><a href="#fnref-1" class="footnote-backref">↩</a></li><li id="fn-2"><a href="https://docs.docker.com/engine/security/protect-access/" target="_blank" rel="noopener noreferrer">Protect the Docker daemon socket | Docker Documentation</a><a href="#fnref-2" class="footnote-backref">↩</a></li><li id="fn-3"><a href="https://www.gaoyaxuan.net/blog/324.html" target="_blank" rel="noopener noreferrer">Docker 开启 TLS 访问，更加安全 - 实用教程 - 高亚轩的 BLOG</a><a href="#fnref-3" class="footnote-backref">↩</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/docker">docker</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/bobo2334/bobo2334.github.io/edit/master/blog/enable-docker-remote-api-with-tls-protection.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/enable-docker-remote-api-with-tls-protection-via-container"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« <!-- -->以容器的方式暴露 Docker Remote API 并启用 TLS</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/ssh-certificate-authentication"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">SSH 密钥登录<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link toc-highlight">前言</a></li><li><a href="#签发证书" class="table-of-contents__link toc-highlight">签发证书</a></li><li><a href="#配置-docker" class="table-of-contents__link toc-highlight">配置 Docker</a></li><li><a href="#开放端口" class="table-of-contents__link toc-highlight">开放端口</a></li><li><a href="#测试" class="table-of-contents__link toc-highlight">测试</a></li><li><a href="#用-portainer-连接" class="table-of-contents__link toc-highlight">用 Portainer 连接</a></li></ul></div></div></div></div></div></div>
<script src="/assets/js/runtime~main.9976181a.js"></script>
<script src="/assets/js/main.d048cc3c.js"></script>
</body>
</html>