<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.24">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><title>开启 Docker Remote API 并启用 TLS | 我的学习笔记</title><meta name="description" content="Just playing around">
    <link rel="modulepreload" href="/assets/app.374a34b2.js"><link rel="modulepreload" href="/assets/enable-docker-remote-api-with-tls-protection.html.81a083f6.js"><link rel="modulepreload" href="/assets/enable-docker-remote-api-with-tls-protection.html.416f8ee0.js">
    <link rel="stylesheet" href="/assets/style.1aed56ca.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">我的学习笔记</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">开启 Docker Remote API 并启用 TLS</p><ul class=""><li><!--[--><a aria-current="page" href="/articles/enable-docker-remote-api-with-tls-protection.html#前言" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="前言"><!--[--><!--]--> 前言 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/articles/enable-docker-remote-api-with-tls-protection.html#签发证书" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="签发证书"><!--[--><!--]--> 签发证书 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/articles/enable-docker-remote-api-with-tls-protection.html#配置-docker" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="配置 Docker"><!--[--><!--]--> 配置 Docker <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/articles/enable-docker-remote-api-with-tls-protection.html#开放端口" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="开放端口"><!--[--><!--]--> 开放端口 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/articles/enable-docker-remote-api-with-tls-protection.html#测试" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="测试"><!--[--><!--]--> 测试 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/articles/enable-docker-remote-api-with-tls-protection.html#用-portainer-连接" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="用 Portainer 连接"><!--[--><!--]--> 用 Portainer 连接 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="开启-docker-remote-api-并启用-tls" tabindex="-1"><a class="header-anchor" href="#开启-docker-remote-api-并启用-tls" aria-hidden="true">#</a> 开启 Docker Remote API 并启用 TLS</h1><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>Portainer<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup> 是一款 Docker 可视化管理面板，它不仅可以管理本地的 Docker 实例，还可以通过 Docker Remote API 访问管理远程 Docker 资源。Docker Remote API 就是通过 HTTP 协议暴露 Docker 资源，启用 TLS 可以实现远程访问鉴权。</p><p>Docker 的官方文档提供了详细的开启 Docker Remote API 和开启 TLS 的教程<sup class="footnote-ref"><a href="#footnote2">[2]</a><a class="footnote-anchor" id="footnote-ref2"></a></sup>。但是在签发证书的过程中涉及到的命令比较多，且繁琐，我就从网络上寻找到了别人写好的签发证书的脚本<sup class="footnote-ref"><a href="#footnote3">[3]</a><a class="footnote-anchor" id="footnote-ref3"></a></sup>，可以很方便地替代纯手工操作。</p><p>本文中的操作都在 CentOS 7 中完成。</p><h2 id="签发证书" tabindex="-1"><a class="header-anchor" href="#签发证书" aria-hidden="true">#</a> 签发证书</h2><p>将脚本命名为 <code>auto-tls-certs.sh</code> 。其中需要配置的内容有：</p><ol><li><code>CODE</code> ，作为文件名的后缀，用于区分文件；</li><li><code>IP</code> ，机器的公网 IP 地址；</li><li><code>PASSWORD</code> ，证书密码。</li></ol><p>脚本内容如下：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#</span>
<span class="token comment"># -------------------------------------------------------------</span>
<span class="token comment"># 自动创建 Docker TLS 证书</span>
<span class="token comment"># -------------------------------------------------------------</span>

<span class="token comment"># 以下是配置信息</span>
<span class="token comment"># --[BEGIN]------------------------------</span>

<span class="token assign-left variable">CODE</span><span class="token operator">=</span><span class="token string">&quot;tx&quot;</span>
<span class="token assign-left variable">IP</span><span class="token operator">=</span><span class="token string">&quot;1.1.1.1&quot;</span>
<span class="token assign-left variable">PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;pass&quot;</span>

<span class="token assign-left variable">COUNTRY</span><span class="token operator">=</span><span class="token string">&quot;CN&quot;</span>
<span class="token assign-left variable">STATE</span><span class="token operator">=</span><span class="token string">&quot;BEIJING&quot;</span>
<span class="token assign-left variable">CITY</span><span class="token operator">=</span><span class="token string">&quot;BEIJING&quot;</span>
<span class="token assign-left variable">ORGANIZATION</span><span class="token operator">=</span><span class="token string">&quot;Org&quot;</span>
<span class="token assign-left variable">ORGANIZATIONAL_UNIT</span><span class="token operator">=</span><span class="token string">&quot;Dev&quot;</span>
<span class="token assign-left variable">COMMON_NAME</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$IP</span>&quot;</span>
<span class="token assign-left variable">EMAIL</span><span class="token operator">=</span><span class="token string">&quot;.&quot;</span>

<span class="token comment"># --[END]--</span>

<span class="token comment"># Generate CA key</span>
openssl genrsa -aes256 -passout <span class="token string">&quot;pass:<span class="token variable">$PASSWORD</span>&quot;</span> -out <span class="token string">&quot;ca-key-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token number">4096</span>
<span class="token comment"># Generate CA</span>
openssl req -new -x509 -days <span class="token number">365</span> -key <span class="token string">&quot;ca-key-<span class="token variable">$CODE</span>.pem&quot;</span> -sha256 -out <span class="token string">&quot;ca-<span class="token variable">$CODE</span>.pem&quot;</span> -passin <span class="token string">&quot;pass:<span class="token variable">$PASSWORD</span>&quot;</span> -subj <span class="token string">&quot;/C=<span class="token variable">$COUNTRY</span>/ST=<span class="token variable">$STATE</span>/L=<span class="token variable">$CITY</span>/O=<span class="token variable">$ORGANIZATION</span>/OU=<span class="token variable">$ORGANIZATIONAL_UNIT</span>/CN=<span class="token variable">$COMMON_NAME</span>/emailAddress=<span class="token variable">$EMAIL</span>&quot;</span>
<span class="token comment"># Generate Server key</span>
openssl genrsa -out <span class="token string">&quot;server-key-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token number">4096</span>

<span class="token comment"># Generate Server Certs.</span>
openssl req -subj <span class="token string">&quot;/CN=<span class="token variable">$COMMON_NAME</span>&quot;</span> -sha256 -new -key <span class="token string">&quot;server-key-<span class="token variable">$CODE</span>.pem&quot;</span> -out server.csr

<span class="token builtin class-name">echo</span> <span class="token string">&quot;subjectAltName = IP:<span class="token variable">$IP</span>,IP:127.0.0.1&quot;</span> <span class="token operator">&gt;&gt;</span> extfile.cnf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;extendedKeyUsage = serverAuth&quot;</span> <span class="token operator">&gt;&gt;</span> extfile.cnf

openssl x509 -req -days <span class="token number">365</span> -sha256 -in server.csr -passin <span class="token string">&quot;pass:<span class="token variable">$PASSWORD</span>&quot;</span> -CA <span class="token string">&quot;ca-<span class="token variable">$CODE</span>.pem&quot;</span> -CAkey <span class="token string">&quot;ca-key-<span class="token variable">$CODE</span>.pem&quot;</span> -CAcreateserial -out <span class="token string">&quot;server-cert-<span class="token variable">$CODE</span>.pem&quot;</span> -extfile extfile.cnf


<span class="token comment"># Generate Client Certs.</span>
<span class="token function">rm</span> -f extfile.cnf

openssl genrsa -out <span class="token string">&quot;key-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token number">4096</span>
openssl req -subj <span class="token string">&#39;/CN=client&#39;</span> -new -key <span class="token string">&quot;key-<span class="token variable">$CODE</span>.pem&quot;</span> -out client.csr
<span class="token builtin class-name">echo</span> extendedKeyUsage <span class="token operator">=</span> clientAuth <span class="token operator">&gt;&gt;</span> extfile.cnf
openssl x509 -req -days <span class="token number">365</span> -sha256 -in client.csr -passin <span class="token string">&quot;pass:<span class="token variable">$PASSWORD</span>&quot;</span> -CA <span class="token string">&quot;ca-<span class="token variable">$CODE</span>.pem&quot;</span> -CAkey <span class="token string">&quot;ca-key-<span class="token variable">$CODE</span>.pem&quot;</span> -CAcreateserial -out <span class="token string">&quot;cert-<span class="token variable">$CODE</span>.pem&quot;</span> -extfile extfile.cnf

<span class="token function">rm</span> -vf client.csr server.csr

<span class="token function">chmod</span> -v 0400 <span class="token string">&quot;ca-key-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;key-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;server-key-<span class="token variable">$CODE</span>.pem&quot;</span>
<span class="token function">chmod</span> -v 0444 <span class="token string">&quot;ca-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;server-cert-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;cert-<span class="token variable">$CODE</span>.pem&quot;</span>

<span class="token comment"># 打包客户端证书</span>
<span class="token function">mkdir</span> -p <span class="token string">&quot;tls-client-certs-<span class="token variable">$CODE</span>&quot;</span>
<span class="token function">cp</span> -f <span class="token string">&quot;ca-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;cert-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;key-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;tls-client-certs-<span class="token variable">$CODE</span>/&quot;</span>
<span class="token builtin class-name">cd</span> <span class="token string">&quot;tls-client-certs-<span class="token variable">$CODE</span>&quot;</span>
<span class="token function">tar</span> zcf <span class="token string">&quot;tls-client-certs-<span class="token variable">$CODE</span>.tar.gz&quot;</span> *
<span class="token function">mv</span> <span class="token string">&quot;tls-client-certs-<span class="token variable">$CODE</span>.tar.gz&quot;</span> <span class="token punctuation">..</span>/
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token function">rm</span> -rf <span class="token string">&quot;tls-client-certs-<span class="token variable">$CODE</span>&quot;</span>

<span class="token comment"># 拷贝服务端证书</span>
<span class="token function">mkdir</span> -p /etc/docker/certs.d
<span class="token function">cp</span> <span class="token string">&quot;ca-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;server-cert-<span class="token variable">$CODE</span>.pem&quot;</span> <span class="token string">&quot;server-key-<span class="token variable">$CODE</span>.pem&quot;</span> /etc/docker/certs.d/
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>使用 <code>sh auto-tls-certs.sh</code> 命令来生成证书，并且生成好的证书会被自动打包为 <code>.tar.gz</code> 归档，非常方便。下面的图片展示了执行脚本后生成的文件列表。</p><p><img src="/assets/image-20210816222131111-16291236956091.a0e8b195.png" alt="image-20210816222131111-16291236956091"></p><h2 id="配置-docker" tabindex="-1"><a class="header-anchor" href="#配置-docker" aria-hidden="true">#</a> 配置 Docker</h2><p>只需关注 <code>.pem</code> 文件，把证书找个专门的位置存放。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> /etc/.docker
<span class="token function">cp</span> ~/docker-cert/*.pem /etc/.docker/
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>修改 Docker 启动文件。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">nano</span> /lib/systemd/system/docker.service
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>修改 <code>Service</code> 下的 <code>ExecStart</code> 配置。</p><div class="language-conf ext-conf line-numbers-mode"><pre class="language-conf"><code>ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock -D -H tcp://0.0.0.0:2376 --tlsverify --tlscacert=/etc/.docker/ca-tx.pem --tlscert=/etc/.docker/server-cert-tx.pem --tlskey=/etc/.docker/server-key-tx.pem
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><img src="/assets/image-20210816222434122-16291238760702.e2f63f4b.png" alt="image-20210816222434122-16291238760702"></p><p>重启 Docker。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl daemon-reloadservice docker restart
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="开放端口" tabindex="-1"><a class="header-anchor" href="#开放端口" aria-hidden="true">#</a> 开放端口</h2><p>在防火墙、安全组中放行 2376 端口。</p><h2 id="测试" tabindex="-1"><a class="header-anchor" href="#测试" aria-hidden="true">#</a> 测试</h2><p>把证书的压缩包 <code>tls-client-certs-tx.tar.gz</code> 下载到本机，解压得到证书文件。</p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ0AAABiCAYAAABKx4YzAAAOeUlEQVR4nO2d32sbZ7rHP9Nmly2F7sXmDzBGsmhIwDmHnAsJTOAUjJRdMHsgSvYmbsFSc3oh3YRg1kcXxuATciOxCUUKtEov2spXgh5LGHJxMMi9KSRsfVpkqcbNZpcmSwrJbrslJ553L2Y0mpFGlib+IY/zfGCMNfPOzOPB+up5nhl9X+2LL75QCIIgDIimlBLREIbG5uZm17rR0dEhRCIMyrGNjY1hxyC8pIyNjQ07BOEFeGXYAQiC4C+O7bTx8ZOnPH76lL/9+CN/+/FHAF5/7TV++frr/OqNN/jVL984kCAFQTg8uGYaPz17RuPBA/74zTfcf/iQi7/5NbpSPN/e5snf/879hw/54zff0HjwgJ+ePTvomAVBGCJdovHTs2c0H/yZb797yLauA/B/jSbvXojzyivt4du6zrffPaT54M8ehWOVTCjD6q5DdzneVpF4KE5xa88OLghCB12i8adHj/ju++8d6779y18AePdCHE3THNu++/57/vTo0T6GKAjCYcIhGo+fPOXBo792DWqJBsDlixe6hOPBo7/y+MnTHqfYohgPkdm71KI3I9OU6iWmR3ZzkAOMd1fnepF9D/JvOwiqJLUIueYAQ5s5IpqGpiWpAtWkRrK63/EdTRyN0MdPn1olCcB//u6i606XL17g/U8+pfWIx7au8/jpU2mMCgdIlaQWowAQ1Eh3bA1nG9RSAZq5CMH0GpCgohRRMASkkGAuf9AxHw0cmcaTH35wbHz/k0977nj54gXH6859W2RCkyzeg9JMiFC8SGe7YasYJxQKmUu/XscqGWtsiHhn82KrSNxxjF7jV8mE4hSLmY5tq33j7R9Lr/WtT3lzezxO3OVcg12P7jhXi3HH+NVMiJAjpejxt20Vidvibe/SGa/btbD/reb1dP07zGWPUpxmLoKmxaCiUKpjaWQJh7PcTgUACKRqKNUgG7b2JncpzRoFYpqGZlsiA6UsgiPT+OEf/3BsVErx/iefWgKhK0X+0xJuD5F27ttivr7CaHySzffqzE8A9rfBVpGriyFu1UtM9A11lUxohvrsCnVH/XF/h/E3GV2pUx8B400wSWa0Fcc9Fjffo16fN944k1cpni25xOslln7nhNLMHW7V68zT3m6da6tIfKDrMeES5zS3NkPcLL7DxOgHzNRnWSlN9Nlni+IHcK1eZwRgNUNoJsNb9Xnr/M54u68Bt+rUW8eKTwKzAIxMl6hPt4ZmCN0cZaX3BR2YZi5CcOk8DVWjkYyQC9Yw9QGqSbSFEzRqKYxVTXKRIOk1c7tWMH9JUFF5I+uwdtUojwUQ+uMQjbOnx10H2Z8a/fd//Ze9O/vIKCEWmQnVmV2x9yKMf8gSAOPGtvt3KI3PsjJow2L1DiXuwWSIRdvq8c0tjHfEOLPvmP/EI2eJjvcqcD3E0vecEL8131sQvFwPl8swMX+LO6FJQowzuzJP/ys1wvT8tJEVLN4z18UdI3rGu2peA2vjCNPvxVm82TFuq0h8Bm7VpweIpz+BVA2VMn/Pz1HWNJIVxVRZI0YFVbNLQYBUTZGiSlIrM6XyRKmSywWJYgjQJW5TO7fMwnqW21KuDIRDNN5+++1dHezDDz/0uMcE8/U682YqHLrXekO01tvolVDsxPgsKyW3f1YvB/MYS89zDnIf2MP12Au2isQnF2F2hXp9xHzd/V2QF2eVzGSV6MogmeSLEOVKNkwwphmlSrTHsGqZAgUK2jrZRo1UqmN7IEWtti8BHkkcPQ1d17uWWq1mLW6v7YtntooUVwFGmC6tMDt+j81eb8iJt4jfW+QDq7pZpbjTAxld42E1s0fPh/SKZbfn9HI9XFjNGCXTyiwsXrX3LHo8u3J/k3vjs1wz05at/61yz2WYPT7rWF1/6xbFmyX7YIrxGbi127tZ7lSTRh8iaNYehViv/kSTXBkS4QQVNcdXl3I0q0k069ZJg1xE7qR4wSEaz58/dyyff/45Z86csZbnz59bv7uNd2eEs9Fx98biyDSjd1qNskkWQ7d26CNMML8yS32mNf4Oozv+N3aOD3HnrR1Kg0Hi7RuL13N2nMvT9XDuW8yEmKkbAjAyfY1ZFpnsajx2nG/iHWOcGevVzRDuBeog1+AqRNulzWrG1nTdw0ZoSywW1sOEs43uRqhSqErCGt/MXWLpxBQnAIiSr41xPQaVfCstCZKqVSA24K1bAa1er1tdzXjcWc/evXuX06dPc/fuXQBOnz7tWN9JqVTqWie8RLQanq7lWTdjY2Mv/NV4qx+RcmleVpNENq5QSwWoJpOQv8JG5DpjtStsRIJ8NafIRzuO0dVEFXqxY6bRWnfq1Cnr97t373Lq1Kmusb0zDeFoskUx3nF7e6bEePTsnjQ8B2EtHXSUJNYSK1hjonn7XRKjMZp3631E8ygRjIFwNEI73/hvvvkmX3/9ddf2L7/80touvKyMMH1tlHgoxIy5Znx2hdJ+NDB60HqAq4tqkshONjHVpCUsiYrIhFcc5cm5c+d2dbDl5eVdByS8POymPBGGhyPTkDe9IAj9EOcuQRA8cUx8GgVB8IJkGoIgeEJEQxAET4hoCILgCRENQRA8IaIhCIIndpz3RBAOGx9//DG6UihdRymFriuU0q11ulK89otfEI1GOX78+LDDPZKIaAi+QleK311se9cq64fB0lKJ8fFx/md5mV+fOyfCsQ9IeSL4CmX6tmzrOtvbOtvb22xvb/PcXACOHz/Ov505w2effTbMUI8skmkIvsLyp1Wg6PSqNV5/9NFHABz7+c8PMLKXBxENwVfouiEMlmAoR3XCb3/7Hyjg2KuvcuNmp2GpsBdIeSL4CqX0tkh0CEbna129gAXlwDRfWptAEQ3BV+jKVIZOwXAUK2Y2ondPtSHsHhENwVe0GqGdgmFPP6y2h8v8PAZVkm4mxNbUjcbSO4uoktSM+VQKMQ0tkqOai1hTPoLpZdp1gFZ24jy/c1iP2FpTUFbbMSaN+SUPfLInEQ3BV+iWELTSDUMk7CWLNdbVId+YznHdZkpsuH81yV2H2zZz4kKsLQJOouTNWdsSFYWqpYimalQSBRZyTagmia1nabj6CkIhVmbK9TxVktoCJxotk+QG55eCNlFZI71gxlhJGIJVnrJmliN9vUe8e4uIhuArjJJDtfTCWZIoZ4nimmlUyxRs0za2CZDKpyAX6fIZdX7693Ytj+YrnEwH0WLrZG/39htNVGy+pdErZMMFylUzNtZIB1vnMrKZ9Y3WCcPt40anSBAme8U8UmCMk6yzcQDJhoiG4Ct0sxHa1c9wZBuGeHhqhJqlySVut+eEtTZGyVtTJNimgdwPwlkaHVMyuPqgDhERDcFXtJ/TaJUm7R5Ga7tVwLg1QqNTJNbSXLfy+Cq5XBMaX7Fmy0Cay0usde+9I9WkUfY0spC+lKMJphg5s5NCuV1ENHOXSK8lmIq6xQbVZK8SaXiIaAi+QteV1ffszjaca3TXRmiUfCPLujUjW5mxVMAoE0gTNMuQS1+dtGUabgQ4dz5sNUJzSY3YuiE6gdRt41g9OqkJylbzMpg+aZuMujM2jfKUc6Lqw4CmereYBWHf8epG/ocbN7j87mX+vzXdhup+LhTgZz87xn9fu8Z//f73exTpXmDMYt+arMmvyBOhgq/QlUKhOHbs1f5j5TmNfUFEQ/AVSlf84cYNlK7Mr8abX5FXOkpXhqgo3fzKvIjGfiDliTBUZLIk/yGNUEEQPCGiIQiCJ0Q0BEHwhIiGIAiekLsngq8QY+HhI6Ih+AoxFh4+Up4IvkKMhYePZBqCrxBj4eEjoiH4CjEWHj5Sngi+wl/GwkfTfFhEQ/AVYiw8fEQ0BF+xr8bCPdd3GAJHIkQ6jIW7XfaOrvmwiIbgK/bPWLifqa/NELhWo9ZhLNxtyHd0zYelESr4CoexsHNLx7qdjYUbnb6bpqkvQY20bXV4o0nLOsthCNx9YJJaDMOOOEy24e4lGs1XKGtBNMJkG3kP5sNBytU8UfrF2Wk+vM4Jh/nwEhtNiO7CdlREQ/AVOxkLt1++gLEwGKa+rlnDICm9YT6c93bGF6NnnI2DOLuUJ4K/2Ddj4QMy9T0K5sMiGoKv2DdjYc+mvk5jYfdc5GiaD4tzlzBUXi5j4UE4/ObD0tMQfIUYCw8fEQ3BV4ix8PCR8kQYKmIs7D+kESoIgidENARB8ISIhiAInhDREATBE3L3RPAVYiw8fEQ0BF8hxsLDR8oTwVeIsfDwkUxD8BW7NxY+/I9pH3ZENARfIcbCw0fKE8FXHB5j4Z04mobCLUQ0BF8hxsLDR0RD8BV7Yyxso2ma8FppgZtpr5E5OEx5q8mXzlC4hYiG4Ct2byxso5pECy5xvqFQ+Si9TXsDpOYSrC0tWyJRLRdIzL1chsItRDQEX+EwFu4wEnYa8vT5anw5iRaDirIZAJvmwulg69PcyBjWN1p2gEssNwGqlAum/Z7j099p2Wcnmq9wMh1Ei623jX9d6DYULlCu9okN6DYUDpN1GAqvs7FHyYaIhuArdjIWbmcb/Y2FC+vrhN3eSOEsDct71D7FQZQrWVhabtLMLVBITLXt96yx7g7ke0bP2A4WEQ3BV+zaWNgkMVej1jjPUtDWN+hj2hs4dx6WrnN9ifan+IAcBUPhFvKchuAr7MbCTjqmMaCXsbCNQIqaGjPKCxJUVJ58I0skqKGZQxIV27QEgRRzJw1z4MaOH/CGoXA6plEIZ8meTJNez9LIBwhwm+xSkGByDHWle0/DUDhmveo0FO4Z2wEizl3CUPGbsXA1qbFworEPZYF/nlSVTEPwFUM1Fm7mWCgkmFMH30c4TIhoCL5iWMbC1aRGrGCUBIc8Edh3pDwRhooYC/sPuXsiCIInRDQEQfCEiIYgCJ4Q0RAEwRMiGoIgeEJEQxAET4hoCILgCRENQRA8IaIhCIInRDQEQfCEiIYgCJ74JzycZ0I/vCTsAAAAAElFTkSuQmCC" alt="image-20210816222527037"></p><p>用 <code>curl</code> 命令测试，如果有 JSON 格式的信息输出则配置成功。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> https://你的IP/info --cert cert-tx.pem --key key-tx.pem --cacert ca-tx.pem
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><img src="/assets/image-20210816222600935-16291239626163.691c82a7.png" alt="image-20210816222600935-16291239626163"></p><h2 id="用-portainer-连接" tabindex="-1"><a class="header-anchor" href="#用-portainer-连接" aria-hidden="true">#</a> 用 Portainer 连接</h2><p>Portainer 是一款非常好用的 Docker 可视化管理工具，通过暴露 Docker Remote API 可以远程连接并管理 Docker 资源。</p><p>在 <code>Endpoints</code> 页面中点击 <code>Add endpoint</code> ， <code>Environment type</code> 选择 <code>Docker</code> 。</p><p>在对应的输入框中填写 IP 地址和端口号，开启 TLS，选择三个对应的证书文件。</p><p><img src="/assets/image-20210816222733033-16291240547284.03df6b5c.png" alt="image-20210816222733033-16291240547284"></p><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://documentation.portainer.io/" target="_blank" rel="noopener noreferrer">Documentation<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li><li id="footnote2" class="footnote-item"><p><a href="https://docs.docker.com/engine/security/protect-access/" target="_blank" rel="noopener noreferrer">Protect the Docker daemon socket | Docker Documentation<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> <a href="#footnote-ref2" class="footnote-backref">↩︎</a></p></li><li id="footnote3" class="footnote-item"><p><a href="https://www.gaoyaxuan.net/blog/324.html" target="_blank" rel="noopener noreferrer">Docker 开启 TLS 访问，更加安全 - 实用教程 - 高亚轩的 BLOG<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> <a href="#footnote-ref3" class="footnote-backref">↩︎</a></p></li></ol></section><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/10/15 下午3:00:02</span></div><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.374a34b2.js" defer></script>
  </body>
</html>
