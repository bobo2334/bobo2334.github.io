<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-database/redis">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Redis | 我的学习笔记</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://iuok.me/docs/database/redis"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="msapplication-TileColor" contnet="#da532c"><meta data-rh="true" name="theme-color" contnet="#ffffff"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Redis | 我的学习笔记"><meta data-rh="true" name="description" content="参考资料"><meta data-rh="true" property="og:description" content="参考资料"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://iuok.me/docs/database/redis"><link data-rh="true" rel="alternate" href="https://iuok.me/docs/database/redis" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://iuok.me/docs/database/redis" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="我的学习笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="我的学习笔记 Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/assets/css/styles.fd12d369.css">
<link rel="preload" href="/assets/js/runtime~main.84225f5f.js" as="script">
<link rel="preload" href="/assets/js/main.9f5be873.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/android-chrome-192x192.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/android-chrome-192x192.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">我的学习笔记</b></a><a class="navbar__item navbar__link" href="/docs/c/">学习笔记</a><a class="navbar__item navbar__link" href="/blog/archive/">文章归档</a><a class="navbar__item navbar__link" href="/blog/tags/">文章标签</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bobo2334/bobo2334.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/c/">C</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/css/">CSS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/database/mysql.1">数据库</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/database/mysql.1">MySQL 基础</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/database/mysql.2">MySQL 进阶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/database/redis">Redis</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/java/">Java</a><button aria-label="打开/收起侧边栏菜单「Java」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/linux/">Linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/markup-language/html">标记语言</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/message-queuing/rocketmq">消息队列</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/postman">Postman</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/regular-expression">正则表达式</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">数据库</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Redis</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Redis</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考资料">参考资料<a href="#参考资料" class="hash-link" aria-label="参考资料的直接链接" title="参考资料的直接链接">​</a></h2><ul><li><a href="https://www.bilibili.com/video/BV1Rv41177Af" target="_blank" rel="noopener noreferrer">【尚硅谷】Redis 6 入门到精通 超详细 教程<!-- -->_<!-- -->哔哩哔哩<!-- -->_<!-- -->bilibili</a></li><li><a href="https://redis.io/commands/" target="_blank" rel="noopener noreferrer">Commands | Redis</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nosql-数据库概述">NoSQL 数据库概述<a href="#nosql-数据库概述" class="hash-link" aria-label="NoSQL 数据库概述的直接链接" title="NoSQL 数据库概述的直接链接">​</a></h2><p>NoSQL（Not Only SQL），意即「不仅仅是 SQL」，泛指非关系型的数据库。
NoSQL 不依赖业务逻辑方式存储，而以简单的 key-value 模式存储。因此大大的增加了数据库的扩展能力。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令">常用命令<a href="#常用命令" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generic">Generic<a href="#generic" class="hash-link" aria-label="Generic的直接链接" title="Generic的直接链接">​</a></h3><ul><li><code>KEYS pattern</code>，查看匹配条件的 key</li><li><code>keys *</code>，查看当前库所有 key</li><li><code>EXISTS key [key ...]</code>，判断某个 key 是否存在</li><li><code>TYPE key</code>，查看你的 key 是什么类型</li><li><code>DEL key [key ...]</code>，删除指定的 key 数据</li><li><code>UNLINK key [key ...]</code>，根据 value 选择非阻塞删除，仅将 keys 从 keyspace 元数据中删除，真正的删除会在后续异步操作</li><li><code>EXPIRE key seconds [NX | XX | GT | LT]</code>，为给定的 key 设置过期时间，时间单位为秒</li><li><code>TTL key</code>，查看还有多少秒过期，-1 表示永不过期，-2 表示已过期</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connection-management">Connection management<a href="#connection-management" class="hash-link" aria-label="Connection management的直接链接" title="Connection management的直接链接">​</a></h3><ul><li><code>SELECT index</code>，切换数据库</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server-managment">Server managment<a href="#server-managment" class="hash-link" aria-label="Server managment的直接链接" title="Server managment的直接链接">​</a></h3><ul><li><code>DBSIZE</code>，查看当前数据库的 key 的数量</li><li><code>FLUSHDB [ASYNC | SYNC]</code>，清空当前库</li><li><code>FLUSHALL [ASYNC | SYNC]</code>，清空所有库</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据类型">数据类型<a href="#数据类型" class="hash-link" aria-label="数据类型的直接链接" title="数据类型的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="string">String<a href="#string" class="hash-link" aria-label="String的直接链接" title="String的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a href="#简介" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>String 是 Redis 最基本的类型，一个 key 对应一个 value。一个 Redis 中字符串 value 最多可以是 512M。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-1">常用命令<a href="#常用命令-1" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>SET key value [NX | XX] [GET] [EX seconds | PX milliseconds | EXAT unix-time-seconds | PXAT unix-time-milliseconds | KEEPTTL]</code></li><li><code>GET key</code></li><li><code>APPEND key value</code></li><li><code>STRLEN key</code></li><li><code>INCR key</code></li><li><code>DECR key</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构">数据结构<a href="#数据结构" class="hash-link" aria-label="数据结构的直接链接" title="数据结构的直接链接">​</a></h4><p>String 的数据结构为简单动态字符串 (Simple Dynamic String，缩写 SDS)。是可以修改的字符串，内部结构实现上类似于 Java 的 ArrayList，采用预分配冗余空间的方式来减少内存的频繁分配。</p><p>String 内部为当前字符串实际分配的空间 capacity 一般要高于实际字符串长度 len。当字符串长度小于 1M 时，扩容都是加倍现有的空间，如果超过 1M，扩容时一次只会多扩 1M 的空间。需要注意的是字符串最大长度为 512M。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="list">List<a href="#list" class="hash-link" aria-label="List的直接链接" title="List的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-1">简介<a href="#简介-1" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。</p><p>它的底层实际是个双向链表，对两端的操作性能很高，通过索引下标的操作中间的节点性能会较差。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-2">常用命令<a href="#常用命令-2" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>LPUSH key element [element ...]</code></li><li><code>LPUSHX key element [element ...]</code></li><li><code>LPOP key [count]</code></li><li><code>RPOP key [count]</code></li><li><code>LINDEX key index</code></li><li><code>LLEN key</code></li><li><code>LINSERT key &lt;BEFORE | AFTER&gt; pivot element</code></li><li><code>LREM key count element</code></li><li><code>LSET key index element</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-1">数据结构<a href="#数据结构-1" class="hash-link" aria-label="数据结构的直接链接" title="数据结构的直接链接">​</a></h4><p><img loading="lazy" alt="image-20220817212141863" src="/assets/images/image-20220817212141863-8c3440595e9204de73cf7b221afed252.png" width="748" height="78" class="img_ev3q"></p><p>List 的数据结构为快速链表 quickList。</p><p>首先在列表元素较少的情况下会使用一块连续的内存存储，这个结构是 ziplist，也即是压缩列表。它将所有的元素紧挨着一起存储，分配的是一块连续的内存。当数据量比较多的时候才会改成 quicklist。</p><p>因为普通的链表需要的附加指针空间太大，会比较浪费空间。比如这个列表里存的只是 int 类型的数据，结构上还需要两个额外的指针 prev 和 next。</p><p>Redis 将链表和 ziplist 结合起来组成了 quicklist。也就是将多个 ziplist 使用双向指针串起来使用。这样既满足了快速的插入删除性能，又不会出现太大的空间冗余。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set">Set<a href="#set" class="hash-link" aria-label="Set的直接链接" title="Set的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-2">简介<a href="#简介-2" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Redis 的 Set 是 string 类型的无序集合。它底层其实是一个 value 为 null 的 hash 表，所以添加，删除，查找的复杂度都是 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-3">常用命令<a href="#常用命令-3" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>SADD key member [member ...]</code></li><li><code>SMEMBERS key</code></li><li><code>SISMEMBER key member</code></li><li><code>SCARD key</code>，返回该集合的元素个数</li><li><code>SREM key member [member ...]</code></li><li><code>SPOP key [count]</code>，随机从该集合中吐出 n 个值</li><li><code>SRANDMEMBER key [count]</code>，随机从该集合中取出 n 个值。不会从集合中删除</li><li><code>SMOVE source destination member</code>，把集合中一个值从一个集合移动到另一个集合</li><li><code>SINTER key [key ...]</code>，返回集合的交集</li><li><code>SUNION key [key ...]</code>，返回集合的并集</li><li><code>SDIFF key [key ...]</code>，返回集合的差集，包含首个 set 中的元素，不包含后续的 set 中的元素</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-2">数据结构<a href="#数据结构-2" class="hash-link" aria-label="数据结构的直接链接" title="数据结构的直接链接">​</a></h4><p>Set 数据结构是 dict 字典，字典是用哈希表实现的。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hash">Hash<a href="#hash" class="hash-link" aria-label="Hash的直接链接" title="Hash的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-3">简介<a href="#简介-3" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Redis hash 是一个键值对集合。</p><p>Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。</p><p>类似 Java 里面的 <code>Map&lt;String, Object&gt;</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-4">常用命令<a href="#常用命令-4" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>HSET key field value [field value ...]</code></li><li><code>HSETNX key field value</code></li><li><code>HGET key field</code></li><li><code>HKEYS key</code></li><li><code>HVALS key</code></li><li><code>HINCRBY key field increment</code></li><li><code>HINCRBYFLOAT key field increment</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-3">数据结构<a href="#数据结构-3" class="hash-link" aria-label="数据结构的直接链接" title="数据结构的直接链接">​</a></h4><p>Hash 类型对应的数据结构是两种：ziplist（压缩列表），hashtable（哈希表）。当 field-value 长度较短且个数较少时，使用 ziplist，否则使用 hashtable。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sorted-set">Sorted Set<a href="#sorted-set" class="hash-link" aria-label="Sorted Set的直接链接" title="Sorted Set的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-4">简介<a href="#简介-4" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Redis 有序集合 zset 与普通集合 set 非常相似，是一个没有重复元素的字符串集合。</p><p>不同之处是有序集合的每个成员都关联了一个评分（score），这个评分（score）被用来按照从最低分到最高分的方式排序集合中的成员。集合的成员是唯一的，但是评分可以是重复了。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-5">常用命令<a href="#常用命令-5" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>ZADD key [NX | XX] [GT | LT] [CH] [INCR] score member [score member ...]</code></li><li><code>ZRANGE key start stop [BYSCORE | BYLEX] [REV] [LIMIT offset count] [WITHSCORES]</code></li><li><code>ZINCRBY key increment member</code></li><li><code>ZREM key member [member ...]</code></li><li><code>ZCOUNT key min max</code></li><li><code>ZRANK key member</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-4">数据结构<a href="#数据结构-4" class="hash-link" aria-label="数据结构的直接链接" title="数据结构的直接链接">​</a></h4><p>SortedSet(zset) 是 Redis 提供的一个非常特别的数据结构，一方面它等价于 Java 的数据结构 <code>Map&lt;String, Double&gt;</code>，可以给每一个元素 value 赋予一个权重 score，另一方面它又类似于 TreeSet，内部的元素会按照权重 score 进行排序，可以得到每个元素的名次，还可以通过 score 的范围来获取元素的列表。</p><p>zset 底层使用了两个数据结构。</p><ol><li>hash，hash 的作用就是关联元素 value 和权重 score，保障元素 value 的唯一性，可以通过元素 value 找到相应的 score 值；</li><li>跳跃表，跳跃表的目的在于给元素 value 排序，根据 score 的范围获取元素列表。</li></ol><p><img loading="lazy" alt="image-20220818011945457" src="/assets/images/image-20220818011945457-af804b75a250bae026368e6fe2c923a0.png" width="778" height="228" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bitmap">Bitmap<a href="#bitmap" class="hash-link" aria-label="Bitmap的直接链接" title="Bitmap的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-5">简介<a href="#简介-5" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Bitmap 是可以进行位操作的字符串，可以看做是位组成的数组。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-6">常用命令<a href="#常用命令-6" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>SETBIT key offset value</code>，设置 Bitmap 中某个偏移量的值（0 或 1）</li><li><code>GETBIT key offset</code>，获取 Bitmap 中某个偏移量的值</li><li><code>BITCOUNT key [start end [BYTE | BIT]]</code>，统计字符串被设置为 1 的 bit 数</li><li><code>BITOP operation destkey key [key ...]</code>，求多个 Bitmap 的交集、并集、差集或者异或的结果</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hyperloglog">HyperLogLog<a href="#hyperloglog" class="hash-link" aria-label="HyperLogLog的直接链接" title="HyperLogLog的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-6">简介<a href="#简介-6" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定的、并且是很小的。</p><p>简单理解就是只存元素的 hash，不存储原始数据的 set。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-7">常用命令<a href="#常用命令-7" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>PFADD key [element [element ...]]</code></li><li><code>PFCOUNT key [key ...]</code></li><li><code>PFMERGE destkey sourcekey [sourcekey ...]</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="geospatial-indices">Geospatial indices<a href="#geospatial-indices" class="hash-link" aria-label="Geospatial indices的直接链接" title="Geospatial indices的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="简介-7">简介<a href="#简介-7" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h4><p>Redis 3.2 中增加了对 GEO 类型的支持。GEO，Geographic，地理信息的缩写。该类型，就是元素的 2 维坐标，在地图上就是经纬度。Redis 基于该类型，提供了经纬度设置，查询，范围查询，距离查询，经纬度 Hash 等常见操作。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-8">常用命令<a href="#常用命令-8" class="hash-link" aria-label="常用命令的直接链接" title="常用命令的直接链接">​</a></h4><ul><li><code>GEOADD key [NX | XX] [CH] longitude latitude member [longitude latitude member ...]</code></li><li><code>GEOPOS key member [member ...]</code></li><li><code>GEODIST key member1 member2 [M | KM | FT | MI]</code>，获取两个位置之间的直线距离</li><li><code>GEORADIUS key longitude latitude radius &lt;M | KM | FT | MI&gt; [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count [ANY]] [ASC | DESC] [STORE key] [STOREDIST key]</code>，以给定的经纬度为中心，找出某一半径内的元素</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置文件">配置文件<a href="#配置文件" class="hash-link" aria-label="配置文件的直接链接" title="配置文件的直接链接">​</a></h2><p>// TODO</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="发布和订阅">发布和订阅<a href="#发布和订阅" class="hash-link" aria-label="发布和订阅的直接链接" title="发布和订阅的直接链接">​</a></h2><p>Redis 发布订阅 (pub/sub) 是一种消息通信模式：发送者 (pub) 发送消息，订阅者 (sub) 接收消息。</p><p>Redis 客户端可以订阅任意数量的频道。</p><ul><li><code>SUBSCRIBE channel [channel ...]</code></li><li><code>PUBLISH channel message</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="持久化">持久化<a href="#持久化" class="hash-link" aria-label="持久化的直接链接" title="持久化的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rdb">RDB<a href="#rdb" class="hash-link" aria-label="RDB的直接链接" title="RDB的直接链接">​</a></h3><p>RDB 在指定的时间间隔内将内存中的数据集快照写入磁盘，也就是行话讲的 Snapshot 快照，它恢复时是将快照文件直接读到内存里。</p><p>Redis 会单独创建（fork）一个子进程来进行持久化，会先将数据写入到 一个临时文件中，待持久化过程都结束了，再用这个临时文件替换上次持久化好的文件。整个过程中，主进程是不进行任何 IO 操作的，这就确保了极高的性能 如果需要进行大规模数据的恢复，且对于数据恢复的完整性不是非常敏感，那 RDB 方式要比 AOF 方式更加的高效。RDB 的缺点是最后一次持久化后的数据可能丢失。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aof">AOF<a href="#aof" class="hash-link" aria-label="AOF的直接链接" title="AOF的直接链接">​</a></h3><p>以日志的形式来记录每个写操作（增量保存），将 Redis 执行过的所有写指令记录下来（读操作不记录），只许追加文件但不可以改写文件，Redis 启动之初会读取该文件重新构建数据，换言之，Redis 重启的话就根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="主从复制">主从复制<a href="#主从复制" class="hash-link" aria-label="主从复制的直接链接" title="主从复制的直接链接">​</a></h2><p>// TODO</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="集群">集群<a href="#集群" class="hash-link" aria-label="集群的直接链接" title="集群的直接链接">​</a></h2><p>// TODO</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="常见问题">常见问题<a href="#常见问题" class="hash-link" aria-label="常见问题的直接链接" title="常见问题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="缓存穿透">缓存穿透<a href="#缓存穿透" class="hash-link" aria-label="缓存穿透的直接链接" title="缓存穿透的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="问题描述">问题描述<a href="#问题描述" class="hash-link" aria-label="问题描述的直接链接" title="问题描述的直接链接">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="解决方案">解决方案<a href="#解决方案" class="hash-link" aria-label="解决方案的直接链接" title="解决方案的直接链接">​</a></h4><h3 class="anchor anchorWithStickyNavbar_LWe7" id="缓存击穿">缓存击穿<a href="#缓存击穿" class="hash-link" aria-label="缓存击穿的直接链接" title="缓存击穿的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="问题描述-1">问题描述<a href="#问题描述-1" class="hash-link" aria-label="问题描述的直接链接" title="问题描述的直接链接">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="解决方案-1">解决方案<a href="#解决方案-1" class="hash-link" aria-label="解决方案的直接链接" title="解决方案的直接链接">​</a></h4><h3 class="anchor anchorWithStickyNavbar_LWe7" id="缓存雪崩">缓存雪崩<a href="#缓存雪崩" class="hash-link" aria-label="缓存雪崩的直接链接" title="缓存雪崩的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="问题描述-2">问题描述<a href="#问题描述-2" class="hash-link" aria-label="问题描述的直接链接" title="问题描述的直接链接">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="解决方案-2">解决方案<a href="#解决方案-2" class="hash-link" aria-label="解决方案的直接链接" title="解决方案的直接链接">​</a></h4><h2 class="anchor anchorWithStickyNavbar_LWe7" id="分布式锁">分布式锁<a href="#分布式锁" class="hash-link" aria-label="分布式锁的直接链接" title="分布式锁的直接链接">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="redis-6">Redis 6<a href="#redis-6" class="hash-link" aria-label="Redis 6的直接链接" title="Redis 6的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="acl">ACL<a href="#acl" class="hash-link" aria-label="ACL的直接链接" title="ACL的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="io-多线程">IO 多线程<a href="#io-多线程" class="hash-link" aria-label="IO 多线程的直接链接" title="IO 多线程的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="工具支持-cluster">工具支持 Cluster<a href="#工具支持-cluster" class="hash-link" aria-label="工具支持 Cluster的直接链接" title="工具支持 Cluster的直接链接">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="其它新特性">其它新特性<a href="#其它新特性" class="hash-link" aria-label="其它新特性的直接链接" title="其它新特性的直接链接">​</a></h3><h2 class="anchor anchorWithStickyNavbar_LWe7" id="redis-7">Redis 7<a href="#redis-7" class="hash-link" aria-label="Redis 7的直接链接" title="Redis 7的直接链接">​</a></h2><p>// TODO</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/database/mysql.2"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">MySQL 进阶</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/java/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Java</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#参考资料" class="table-of-contents__link toc-highlight">参考资料</a></li><li><a href="#nosql-数据库概述" class="table-of-contents__link toc-highlight">NoSQL 数据库概述</a></li><li><a href="#常用命令" class="table-of-contents__link toc-highlight">常用命令</a><ul><li><a href="#generic" class="table-of-contents__link toc-highlight">Generic</a></li><li><a href="#connection-management" class="table-of-contents__link toc-highlight">Connection management</a></li><li><a href="#server-managment" class="table-of-contents__link toc-highlight">Server managment</a></li></ul></li><li><a href="#数据类型" class="table-of-contents__link toc-highlight">数据类型</a><ul><li><a href="#string" class="table-of-contents__link toc-highlight">String</a><ul><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-1" class="table-of-contents__link toc-highlight">常用命令</a></li><li><a href="#数据结构" class="table-of-contents__link toc-highlight">数据结构</a></li></ul></li><li><a href="#list" class="table-of-contents__link toc-highlight">List</a><ul><li><a href="#简介-1" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-2" class="table-of-contents__link toc-highlight">常用命令</a></li><li><a href="#数据结构-1" class="table-of-contents__link toc-highlight">数据结构</a></li></ul></li><li><a href="#set" class="table-of-contents__link toc-highlight">Set</a><ul><li><a href="#简介-2" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-3" class="table-of-contents__link toc-highlight">常用命令</a></li><li><a href="#数据结构-2" class="table-of-contents__link toc-highlight">数据结构</a></li></ul></li><li><a href="#hash" class="table-of-contents__link toc-highlight">Hash</a><ul><li><a href="#简介-3" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-4" class="table-of-contents__link toc-highlight">常用命令</a></li><li><a href="#数据结构-3" class="table-of-contents__link toc-highlight">数据结构</a></li></ul></li><li><a href="#sorted-set" class="table-of-contents__link toc-highlight">Sorted Set</a><ul><li><a href="#简介-4" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-5" class="table-of-contents__link toc-highlight">常用命令</a></li><li><a href="#数据结构-4" class="table-of-contents__link toc-highlight">数据结构</a></li></ul></li><li><a href="#bitmap" class="table-of-contents__link toc-highlight">Bitmap</a><ul><li><a href="#简介-5" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-6" class="table-of-contents__link toc-highlight">常用命令</a></li></ul></li><li><a href="#hyperloglog" class="table-of-contents__link toc-highlight">HyperLogLog</a><ul><li><a href="#简介-6" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-7" class="table-of-contents__link toc-highlight">常用命令</a></li></ul></li><li><a href="#geospatial-indices" class="table-of-contents__link toc-highlight">Geospatial indices</a><ul><li><a href="#简介-7" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#常用命令-8" class="table-of-contents__link toc-highlight">常用命令</a></li></ul></li></ul></li><li><a href="#配置文件" class="table-of-contents__link toc-highlight">配置文件</a></li><li><a href="#发布和订阅" class="table-of-contents__link toc-highlight">发布和订阅</a></li><li><a href="#持久化" class="table-of-contents__link toc-highlight">持久化</a><ul><li><a href="#rdb" class="table-of-contents__link toc-highlight">RDB</a></li><li><a href="#aof" class="table-of-contents__link toc-highlight">AOF</a></li></ul></li><li><a href="#主从复制" class="table-of-contents__link toc-highlight">主从复制</a></li><li><a href="#集群" class="table-of-contents__link toc-highlight">集群</a></li><li><a href="#常见问题" class="table-of-contents__link toc-highlight">常见问题</a><ul><li><a href="#缓存穿透" class="table-of-contents__link toc-highlight">缓存穿透</a><ul><li><a href="#问题描述" class="table-of-contents__link toc-highlight">问题描述</a></li><li><a href="#解决方案" class="table-of-contents__link toc-highlight">解决方案</a></li></ul></li><li><a href="#缓存击穿" class="table-of-contents__link toc-highlight">缓存击穿</a><ul><li><a href="#问题描述-1" class="table-of-contents__link toc-highlight">问题描述</a></li><li><a href="#解决方案-1" class="table-of-contents__link toc-highlight">解决方案</a></li></ul></li><li><a href="#缓存雪崩" class="table-of-contents__link toc-highlight">缓存雪崩</a><ul><li><a href="#问题描述-2" class="table-of-contents__link toc-highlight">问题描述</a></li><li><a href="#解决方案-2" class="table-of-contents__link toc-highlight">解决方案</a></li></ul></li></ul></li><li><a href="#分布式锁" class="table-of-contents__link toc-highlight">分布式锁</a></li><li><a href="#redis-6" class="table-of-contents__link toc-highlight">Redis 6</a><ul><li><a href="#acl" class="table-of-contents__link toc-highlight">ACL</a></li><li><a href="#io-多线程" class="table-of-contents__link toc-highlight">IO 多线程</a></li><li><a href="#工具支持-cluster" class="table-of-contents__link toc-highlight">工具支持 Cluster</a></li><li><a href="#其它新特性" class="table-of-contents__link toc-highlight">其它新特性</a></li></ul></li><li><a href="#redis-7" class="table-of-contents__link toc-highlight">Redis 7</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyleft (ɔ) 2023 iuok.me. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.84225f5f.js"></script>
<script src="/assets/js/main.9f5be873.js"></script>
</body>
</html>